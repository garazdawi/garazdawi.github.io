<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Erlang Programming Language</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"/><meta name="description" content="Erlang Programming Language"/><meta name="keywords" content="erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="alternate" type="application/rss+xml" title="Overall RSS 2.0 Feed" href="/rss"/><link rel="alternate" type="application/rss+xml" title="News RSS 2.0 Feed" href="/rss/news"/><link rel="alternate" type="application/rss+xml" title="Article RSS 2.0 Feed" href="/rss/articles"/><link rel="alternate" type="application/rss+xml" title="Events RSS 2.0 Feed" href="/rss/event"/><link rel="alternate" type="application/rss+xml" title="Downloads RSS 2.0 Feed" href="/rss/download"/><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><link rel="preload" href="/_next/static/css/f91c265ba4ec340e076d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f91c265ba4ec340e076d.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-79f3144d8877c67ce98b.js" as="script"/><link rel="preload" href="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" as="script"/></head><body><div id="__next"><div class="navbar" style="background-color:#FFF;margin-bottom:0px"><div class="container"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse" style="position:absolute;right:5px;margin-bottom:0px"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="/img/erlang.png" width="60"/></a><div class="nav-collapse collapse navbar-responsive-collapse" style="padding:20px"><ul class="nav navbar-nav"><li><a class="menu-headlines" href="/downloads/"> DOWNLOADS </a></li><li><a class="menu-headlines" href="/docs/"> DOCUMENTATION </a></li><li><a class="menu-headlines" href="/community/"> COMMUNITY </a></li><li><a class="menu-headlines" href="/news/"> NEWS </a></li><li><a class="menu-headlines" href="/eeps/"> EEPS </a></li><li><a class="menu-headlines" href="/blog/"> BLOG </a></li><li><a class="menu-headlines" href="/about/"> ABOUT </a></li></ul></div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="static_div"><pre><code>Author: Richard A. O'Keefe &lt;ok(at)cs(dot)otago(dot)ac(dot)nz&gt;
Status: Draft
Type: Standards Track
Erlang-Version: R12B-4
Created: 08-Aug-2008
Post-History:
</code></pre>

<hr />

<h2><a href="/eeps/eep-0000" title="EEP Index">EEP</a> 21: <a href="eep-0021.md" title="EEP Source"> Optional trailing commas for lists and tuples</a></h2>

<h1>Abstract</h1>

<p>Allow an extra comma at the end of a list or tuple.
Darren New proposed this change; Richard O'Keefe, who doesn't
like it very much, wrote it up as an EEP.</p>

<h1>Specification</h1>

<p>A list that would have ended with ",X]" for some term X
may instead end with ",X,]".
A tuple that would have ended with ",X}" for some term X
may instead end with ",X,}".
The rule for tuples also applies to records and -record
declarations.</p>

<h1>Motivation</h1>

<p>About 5,000 lines of the Erlang/OTP sources begin with a right
square bracket or right curly brace.  For example, -record
declarations are commonly laid out as</p>

<pre><code>-record(foo, {
    field_1 = default_1,
    ...
    field_n = default_n
 }).
</code></pre>

<p>e.g.,</p>

<pre><code>-record(hostent, {
     h_name,
     h_aliases = [],
     h_addrtype,
     h_length,
     h_addr_list = []
    }).
</code></pre>

<p>and record creation expressions are often laid out similarly, e.g.,</p>

<pre><code>make_hostent(Name, Addrs, Aliases, ?S_A) -&gt;
    #hostent {
          h_name      = Name,
          h_addrtype  = inet,
          h_length    = 4,
          h_addr_list = Addrs,
          h_aliases   = Aliases
         };
</code></pre>

<p>Adding entries to such lists (in the informal sense of "list"),
removing entries, and reordering entries would be simpler if they
were all punctuated the same way.  Lists (in the Erlang sense of
"list") of options are also often laid out like this.</p>

<p>C, C++, Java, and Javascript allow a trailing comma in
initial value lists.  Python allows trailing commas in lists and
dictionaries.  Python in particular is evidence that a programming
language can support this feature without charges of "C envy" or
of extreme ugliness.</p>

<h1>Rationale</h1>

<p>I don't actually feel any need for this proposal; I believe that
the answer is better tool support.  However, many people are
wedded to their tools, even more than their programming languages.
Darren New is not the only one to have asked for it, and with
about 1 SLOC in 110 of the Erlang/OTP sources reflecting a list or
tuple where this feature could have been used, it's very much a
low cost high public appreciation feature.</p>

<p>I wrote that last sentence before working on the parser to make it
accept this "feature".  There are 115 lines of plain diffs.  I
could have made this change to the Prolog parser in 10 minutes,
but then the Prolog parser has the enormous advantage of NOT being
written using an LR parser generator like Yecc.  Still, now that I
<em>have</em> hacked on the parser, the cost to everyone <em>else</em> is low.</p>

<p>The specification was carefully worded.  Commas are NOT allowed in
empty lists or tuples, nor in list or tuple comprehensions.  They
are only allowed after a final element, so <code>[1|L,]</code> is also not
allowed.  Nor are trailing commas allowed inside argument lists,
only in <code>[]</code> and <code>{}</code>.  They are, however, allowed in tuple and
record types.</p>

<p>This is very similar to the "optional semicolons" EEP (which was
FAR simpler to implement).  The heart and soul of that EEP is the
desire to make semicolons and commas look DIFFERENT; for this
reason it is important NOT to allow optional trailing semicolons.
If semicolons may trail, commas must not.
If commas may trail, semicolons must not.
It is also important NOT to approach the "consistent punctuation
for list elements" problem by allowing optional leading commas.
If semicolons may lead, commas must not.
If commas may lead, semicolons must not.
Since trailing commas are established practice in C, C++, Java,
ECMAScript, Python, &amp;c, commas trail, semicolons lead.</p>

<p>I repeat that this is not my idea.  I've just written up the EEP
and figured out how to implement it.  With nearly 1% of the SLOC
in the Erlang/OTP system being cases where people might well have
had reason to add a trailing comma, had it been legal, it seemed
worth while finding out whether it would be practical.</p>

<h1>Backwards Compatibility</h1>

<p>All existing Erlang code remains acceptable with unchanged
semantics.  The commas are dealt with entirely in the parser;
other language manipulation tools never know that they were
there, so work perfectly with code using them.</p>

<h1>Reference Implementation</h1>

<p>The auxiliary file <a href="eep-0021-1.diff" title="Patch for erl_parse.yrl">eep-0021-1.diff</a>
is a patch file to be applied to <code>erl_parse.yrl</code>.</p>

<p>You would think that all we'd need to do would be to change</p>

<pre><code>... ']'                    ... '}'
</code></pre>

<p>to  </p>

<pre><code>... ',' ']'                ... ',' '}'
</code></pre>

<p>in several places.  You would be wrong.  With a different grammar,
maybe.  With the current grammar, this was an uncommonly tricky
change requiring surgery in all sorts of places.  The result gets
through Yecc with no complaints other than the two shift/reduce
complaints that are expected (and have nothing to do with this change).</p>

<h1>Copyright</h1>

<p>This document has been placed in the public domain.</p>
</div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="col-lg-12 text-center"><div class="col-lg-4"><a title="DOWNLOAD" href="/download.html"><img src="/img/download.png"/></a></div><div class="col-lg-4"><a href="http://www.github.com/erlang/otp/"><img src="/img/GitHub-Mark-32px.png"/></a></div><div class="col-lg-4"><a href="http://www.twitter.com/erlang_org/"><img src="/img/twitter.png" width="32"/></a></div></div><div class="col-lg-12"><div class="divider"><p></p></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"index":{"id":"0021","content":"\u003cpre\u003e\u003ccode\u003eAuthor: Richard A. O'Keefe \u0026lt;ok(at)cs(dot)otago(dot)ac(dot)nz\u0026gt;\nStatus: Draft\nType: Standards Track\nErlang-Version: R12B-4\nCreated: 08-Aug-2008\nPost-History:\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003chr /\u003e\n\n\u003ch2\u003e\u003ca href=\"/eeps/eep-0000\" title=\"EEP Index\"\u003eEEP\u003c/a\u003e 21: \u003ca href=\"eep-0021.md\" title=\"EEP Source\"\u003e Optional trailing commas for lists and tuples\u003c/a\u003e\u003c/h2\u003e\n\n\u003ch1\u003eAbstract\u003c/h1\u003e\n\n\u003cp\u003eAllow an extra comma at the end of a list or tuple.\nDarren New proposed this change; Richard O'Keefe, who doesn't\nlike it very much, wrote it up as an EEP.\u003c/p\u003e\n\n\u003ch1\u003eSpecification\u003c/h1\u003e\n\n\u003cp\u003eA list that would have ended with \",X]\" for some term X\nmay instead end with \",X,]\".\nA tuple that would have ended with \",X}\" for some term X\nmay instead end with \",X,}\".\nThe rule for tuples also applies to records and -record\ndeclarations.\u003c/p\u003e\n\n\u003ch1\u003eMotivation\u003c/h1\u003e\n\n\u003cp\u003eAbout 5,000 lines of the Erlang/OTP sources begin with a right\nsquare bracket or right curly brace.  For example, -record\ndeclarations are commonly laid out as\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003e-record(foo, {\n    field_1 = default_1,\n    ...\n    field_n = default_n\n }).\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003ee.g.,\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003e-record(hostent, {\n     h_name,\n     h_aliases = [],\n     h_addrtype,\n     h_length,\n     h_addr_list = []\n    }).\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eand record creation expressions are often laid out similarly, e.g.,\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003emake_hostent(Name, Addrs, Aliases, ?S_A) -\u0026gt;\n    #hostent {\n          h_name      = Name,\n          h_addrtype  = inet,\n          h_length    = 4,\n          h_addr_list = Addrs,\n          h_aliases   = Aliases\n         };\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eAdding entries to such lists (in the informal sense of \"list\"),\nremoving entries, and reordering entries would be simpler if they\nwere all punctuated the same way.  Lists (in the Erlang sense of\n\"list\") of options are also often laid out like this.\u003c/p\u003e\n\n\u003cp\u003eC, C++, Java, and Javascript allow a trailing comma in\ninitial value lists.  Python allows trailing commas in lists and\ndictionaries.  Python in particular is evidence that a programming\nlanguage can support this feature without charges of \"C envy\" or\nof extreme ugliness.\u003c/p\u003e\n\n\u003ch1\u003eRationale\u003c/h1\u003e\n\n\u003cp\u003eI don't actually feel any need for this proposal; I believe that\nthe answer is better tool support.  However, many people are\nwedded to their tools, even more than their programming languages.\nDarren New is not the only one to have asked for it, and with\nabout 1 SLOC in 110 of the Erlang/OTP sources reflecting a list or\ntuple where this feature could have been used, it's very much a\nlow cost high public appreciation feature.\u003c/p\u003e\n\n\u003cp\u003eI wrote that last sentence before working on the parser to make it\naccept this \"feature\".  There are 115 lines of plain diffs.  I\ncould have made this change to the Prolog parser in 10 minutes,\nbut then the Prolog parser has the enormous advantage of NOT being\nwritten using an LR parser generator like Yecc.  Still, now that I\n\u003cem\u003ehave\u003c/em\u003e hacked on the parser, the cost to everyone \u003cem\u003eelse\u003c/em\u003e is low.\u003c/p\u003e\n\n\u003cp\u003eThe specification was carefully worded.  Commas are NOT allowed in\nempty lists or tuples, nor in list or tuple comprehensions.  They\nare only allowed after a final element, so \u003ccode\u003e[1|L,]\u003c/code\u003e is also not\nallowed.  Nor are trailing commas allowed inside argument lists,\nonly in \u003ccode\u003e[]\u003c/code\u003e and \u003ccode\u003e{}\u003c/code\u003e.  They are, however, allowed in tuple and\nrecord types.\u003c/p\u003e\n\n\u003cp\u003eThis is very similar to the \"optional semicolons\" EEP (which was\nFAR simpler to implement).  The heart and soul of that EEP is the\ndesire to make semicolons and commas look DIFFERENT; for this\nreason it is important NOT to allow optional trailing semicolons.\nIf semicolons may trail, commas must not.\nIf commas may trail, semicolons must not.\nIt is also important NOT to approach the \"consistent punctuation\nfor list elements\" problem by allowing optional leading commas.\nIf semicolons may lead, commas must not.\nIf commas may lead, semicolons must not.\nSince trailing commas are established practice in C, C++, Java,\nECMAScript, Python, \u0026amp;c, commas trail, semicolons lead.\u003c/p\u003e\n\n\u003cp\u003eI repeat that this is not my idea.  I've just written up the EEP\nand figured out how to implement it.  With nearly 1% of the SLOC\nin the Erlang/OTP system being cases where people might well have\nhad reason to add a trailing comma, had it been legal, it seemed\nworth while finding out whether it would be practical.\u003c/p\u003e\n\n\u003ch1\u003eBackwards Compatibility\u003c/h1\u003e\n\n\u003cp\u003eAll existing Erlang code remains acceptable with unchanged\nsemantics.  The commas are dealt with entirely in the parser;\nother language manipulation tools never know that they were\nthere, so work perfectly with code using them.\u003c/p\u003e\n\n\u003ch1\u003eReference Implementation\u003c/h1\u003e\n\n\u003cp\u003eThe auxiliary file \u003ca href=\"eep-0021-1.diff\" title=\"Patch for erl_parse.yrl\"\u003eeep-0021-1.diff\u003c/a\u003e\nis a patch file to be applied to \u003ccode\u003eerl_parse.yrl\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eYou would think that all we'd need to do would be to change\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003e... ']'                    ... '}'\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eto  \u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003e... ',' ']'                ... ',' '}'\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003ein several places.  You would be wrong.  With a different grammar,\nmaybe.  With the current grammar, this was an uncommonly tricky\nchange requiring surgery in all sorts of places.  The result gets\nthrough Yecc with no complaints other than the two shift/reduce\ncomplaints that are expected (and have nothing to do with this change).\u003c/p\u003e\n\n\u003ch1\u003eCopyright\u003c/h1\u003e\n\n\u003cp\u003eThis document has been placed in the public domain.\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/eeps/[eep]","query":{"eep":"eep-0021"},"buildId":"BGhkIUi1bNl03TKudis6o","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"charSet":"utf-8"}],["title",{"children":"Erlang Programming Language"}],["meta",{"httpEquiv":"Content-Type","content":"text/html;charset=utf-8"}],["meta",{"name":"description","content":"Erlang Programming Language"}],["meta",{"name":"keywords","content":"erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"}],["meta",{"name":"viewport","content":"width=device-width, initial-scale=1.0"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Overall RSS 2.0 Feed","href":"/rss"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"News RSS 2.0 Feed","href":"/rss/news"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Article RSS 2.0 Feed","href":"/rss/articles"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Events RSS 2.0 Feed","href":"/rss/event"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Downloads RSS 2.0 Feed","href":"/rss/download"}],["script",{"src":"https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"}],["script",{"src":"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js","integrity":"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa","crossOrigin":"anonymous"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-8bebc7aacc0076174a73.js"></script><script src="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" async=""></script><script src="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" async=""></script><script src="/_next/static/chunks/pages/_app-79f3144d8877c67ce98b.js" async=""></script><script src="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" async=""></script><script src="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" async=""></script><script src="/_next/static/BGhkIUi1bNl03TKudis6o/_buildManifest.js" async=""></script><script src="/_next/static/BGhkIUi1bNl03TKudis6o/_ssgManifest.js" async=""></script></body></html>