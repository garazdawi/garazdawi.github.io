<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Erlang Programming Language</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"/><meta name="description" content="Erlang Programming Language"/><meta name="keywords" content="erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="alternate" type="application/rss+xml" title="Overall RSS 2.0 Feed" href="/rss"/><link rel="alternate" type="application/rss+xml" title="News RSS 2.0 Feed" href="/rss/news"/><link rel="alternate" type="application/rss+xml" title="Article RSS 2.0 Feed" href="/rss/articles"/><link rel="alternate" type="application/rss+xml" title="Events RSS 2.0 Feed" href="/rss/event"/><link rel="alternate" type="application/rss+xml" title="Downloads RSS 2.0 Feed" href="/rss/download"/><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><link rel="preload" href="/_next/static/css/4ee9685e1cc0da7f69f0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4ee9685e1cc0da7f69f0.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-290342a5f5c41b7caf9d.js" as="script"/><link rel="preload" href="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" as="script"/></head><body><div id="__next"><div class="navbar" style="background-color:#FFF;margin-bottom:0px"><div class="container"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse" style="position:absolute;right:5px;margin-bottom:0px"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="/img/erlang.png" width="60"/></a><div class="nav-collapse collapse navbar-responsive-collapse" style="padding:20px"><ul class="nav navbar-nav"><li><a class="menu-headlines" href="/downloads/"> DOWNLOADS </a></li><li><a class="menu-headlines" href="/docs/"> DOCUMENTATION </a></li><li><a class="menu-headlines" href="/community/"> COMMUNITY </a></li><li><a class="menu-headlines" href="/news/"> NEWS </a></li><li><a class="menu-headlines" href="/eeps/"> EEPS </a></li><li><a class="menu-headlines" href="/blog/"> BLOG </a></li><li><a class="menu-headlines" href="/about/"> ABOUT </a></li></ul></div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="static_div"><pre><code>Author: James Hague &lt;james(dot)hague(at)gmail(dot)com&gt;
Status: Draft
Type: Standards Track
Created: 18-Feb-2009
Post-History:
</code></pre>

<hr />

<h2><a href="/eeps/eep-0000" title="EEP Index">EEP</a> 27: <a href="eep-0027.md" title="EEP Source"> Multi-Parameter Typechecking BIFs</a></h2>

<h1>Abstract</h1>

<p>Typechecking guards (e.g., <code>is_float/1</code>) are useful for a number of
reasons, but they're verbose.  I propose allowing multiple
parameters to the <code>is_</code> famility of functions, which
significantly reduces source code bulk in common cases.</p>

<h1>Specification</h1>

<p>Where <code>is_type</code> represents any of the <code>is_</code> family of functions,
such as <code>is_float</code>:</p>

<p><code>is_type(A, B, C, ...)</code> is equivalent to <code>(is_type(A) andalso
is_type(B) andalso is_type(C)...)</code>.</p>

<p>The is_type functions can now take from 1 to N parameters, where
N is the implementation defined limit on function arity.</p>

<p>The old-style guards (e.g., <code>float/1</code>) would not change, as some of
those serve double duty as typecasts.</p>

<p>Direct references to these functions in the erlang module are for
the single parameter versions only (such as <code>fun
erlang:is_float/1</code>).</p>

<h1>Motivation</h1>

<p>I find myself adding typechecking guards not only for safety, but
to improve code generation quality, especially when using floats.
Writing three or four element vector math functions in Erlang,
with <code>is_float</code> guards, is verbose.  The <code>is_float</code> checks dwarf what
would otherwise be a single-line function by adding multiple lines
of guards.</p>

<h1>Rationale</h1>

<p>Here's an example from the Wings3D project:</p>

<pre><code>cross({V10,V11,V12}, {V20,V21,V22})
  when is_float(V10), is_float(V11), is_float(V12),
       is_float(V20), is_float(V21), is_float(V22) -&gt;
    {V11*V22-V12*V21,V12*V20-V10*V22,V10*V21-V11*V20}.
</code></pre>

<p>The <code>is_float</code> checks significantly improve the quality of the
generated code, allowing floats to be kept in virtual machine
registers instead of allocated on the heap.  If multiple
parameters to <code>is_float</code> were allowed, this code could be
rewritten as:</p>

<pre><code>cross({V10,V11,V12}, {V20,V21,V22})
  when is_float(V10,V11,V12,V20,V21,V22) -&gt;
    {V11*V22-V12*V21,V12*V20-V10*V22,V10*V21-V11*V20}.
</code></pre>

<p>In the second version, the intent is clearer at a glance, and
the source-level weight of adding typechecking doesn't overwhelm
the function.</p>

<p>Over the years the the Erlang system has become more reliant on
typechecking.  There are the dialyzer and typer tools.  The
compiler can statically infer types and generate better code as
a result. Making typechecking guards be lighter-weight at the
source code level encourages their use and is more in-line with
the overall syntactic density of the language.</p>

<h1>Backwards Compatibility</h1>

<p>All uses of the <code>is_type/1</code> functions will still work if this
proposal were implemented.  Direct references to
<code>erlang:is_float</code>, <code>erlang:is_atom</code>, etc., as funs will still work
as originally intended.</p>

<h1>Reference Implementation</h1>

<p>None.</p>

<h1>Copyright</h1>

<p>This document has been placed in the public domain.</p>
</div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="col-lg-12 text-center"><div class="col-lg-4"><a title="DOWNLOAD" href="/download.html"><img src="/img/download.png"/></a></div><div class="col-lg-4"><a href="http://www.github.com/erlang/otp/"><img src="/img/GitHub-Mark-32px.png"/></a></div><div class="col-lg-4"><a href="http://www.twitter.com/erlang_org/"><img src="/img/twitter.png" width="32"/></a></div></div><div class="col-lg-12"><div class="divider"><p></p></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"index":{"id":"0027","content":"\u003cpre\u003e\u003ccode\u003eAuthor: James Hague \u0026lt;james(dot)hague(at)gmail(dot)com\u0026gt;\nStatus: Draft\nType: Standards Track\nCreated: 18-Feb-2009\nPost-History:\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003chr /\u003e\n\n\u003ch2\u003e\u003ca href=\"/eeps/eep-0000\" title=\"EEP Index\"\u003eEEP\u003c/a\u003e 27: \u003ca href=\"eep-0027.md\" title=\"EEP Source\"\u003e Multi-Parameter Typechecking BIFs\u003c/a\u003e\u003c/h2\u003e\n\n\u003ch1\u003eAbstract\u003c/h1\u003e\n\n\u003cp\u003eTypechecking guards (e.g., \u003ccode\u003eis_float/1\u003c/code\u003e) are useful for a number of\nreasons, but they're verbose.  I propose allowing multiple\nparameters to the \u003ccode\u003eis_\u003c/code\u003e famility of functions, which\nsignificantly reduces source code bulk in common cases.\u003c/p\u003e\n\n\u003ch1\u003eSpecification\u003c/h1\u003e\n\n\u003cp\u003eWhere \u003ccode\u003eis_type\u003c/code\u003e represents any of the \u003ccode\u003eis_\u003c/code\u003e family of functions,\nsuch as \u003ccode\u003eis_float\u003c/code\u003e:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eis_type(A, B, C, ...)\u003c/code\u003e is equivalent to \u003ccode\u003e(is_type(A) andalso\nis_type(B) andalso is_type(C)...)\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe is_type functions can now take from 1 to N parameters, where\nN is the implementation defined limit on function arity.\u003c/p\u003e\n\n\u003cp\u003eThe old-style guards (e.g., \u003ccode\u003efloat/1\u003c/code\u003e) would not change, as some of\nthose serve double duty as typecasts.\u003c/p\u003e\n\n\u003cp\u003eDirect references to these functions in the erlang module are for\nthe single parameter versions only (such as \u003ccode\u003efun\nerlang:is_float/1\u003c/code\u003e).\u003c/p\u003e\n\n\u003ch1\u003eMotivation\u003c/h1\u003e\n\n\u003cp\u003eI find myself adding typechecking guards not only for safety, but\nto improve code generation quality, especially when using floats.\nWriting three or four element vector math functions in Erlang,\nwith \u003ccode\u003eis_float\u003c/code\u003e guards, is verbose.  The \u003ccode\u003eis_float\u003c/code\u003e checks dwarf what\nwould otherwise be a single-line function by adding multiple lines\nof guards.\u003c/p\u003e\n\n\u003ch1\u003eRationale\u003c/h1\u003e\n\n\u003cp\u003eHere's an example from the Wings3D project:\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003ecross({V10,V11,V12}, {V20,V21,V22})\n  when is_float(V10), is_float(V11), is_float(V12),\n       is_float(V20), is_float(V21), is_float(V22) -\u0026gt;\n    {V11*V22-V12*V21,V12*V20-V10*V22,V10*V21-V11*V20}.\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eThe \u003ccode\u003eis_float\u003c/code\u003e checks significantly improve the quality of the\ngenerated code, allowing floats to be kept in virtual machine\nregisters instead of allocated on the heap.  If multiple\nparameters to \u003ccode\u003eis_float\u003c/code\u003e were allowed, this code could be\nrewritten as:\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003ecross({V10,V11,V12}, {V20,V21,V22})\n  when is_float(V10,V11,V12,V20,V21,V22) -\u0026gt;\n    {V11*V22-V12*V21,V12*V20-V10*V22,V10*V21-V11*V20}.\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eIn the second version, the intent is clearer at a glance, and\nthe source-level weight of adding typechecking doesn't overwhelm\nthe function.\u003c/p\u003e\n\n\u003cp\u003eOver the years the the Erlang system has become more reliant on\ntypechecking.  There are the dialyzer and typer tools.  The\ncompiler can statically infer types and generate better code as\na result. Making typechecking guards be lighter-weight at the\nsource code level encourages their use and is more in-line with\nthe overall syntactic density of the language.\u003c/p\u003e\n\n\u003ch1\u003eBackwards Compatibility\u003c/h1\u003e\n\n\u003cp\u003eAll uses of the \u003ccode\u003eis_type/1\u003c/code\u003e functions will still work if this\nproposal were implemented.  Direct references to\n\u003ccode\u003eerlang:is_float\u003c/code\u003e, \u003ccode\u003eerlang:is_atom\u003c/code\u003e, etc., as funs will still work\nas originally intended.\u003c/p\u003e\n\n\u003ch1\u003eReference Implementation\u003c/h1\u003e\n\n\u003cp\u003eNone.\u003c/p\u003e\n\n\u003ch1\u003eCopyright\u003c/h1\u003e\n\n\u003cp\u003eThis document has been placed in the public domain.\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/eeps/[eep]","query":{"eep":"eep-0027"},"buildId":"aoeL97fiGQMaunPBLLCoJ","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"charSet":"utf-8"}],["title",{"children":"Erlang Programming Language"}],["meta",{"httpEquiv":"Content-Type","content":"text/html;charset=utf-8"}],["meta",{"name":"description","content":"Erlang Programming Language"}],["meta",{"name":"keywords","content":"erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"}],["meta",{"name":"viewport","content":"width=device-width, initial-scale=1.0"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Overall RSS 2.0 Feed","href":"/rss"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"News RSS 2.0 Feed","href":"/rss/news"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Article RSS 2.0 Feed","href":"/rss/articles"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Events RSS 2.0 Feed","href":"/rss/event"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Downloads RSS 2.0 Feed","href":"/rss/download"}],["script",{"src":"https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"}],["script",{"src":"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js","integrity":"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa","crossOrigin":"anonymous"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-8bebc7aacc0076174a73.js"></script><script src="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" async=""></script><script src="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" async=""></script><script src="/_next/static/chunks/pages/_app-290342a5f5c41b7caf9d.js" async=""></script><script src="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" async=""></script><script src="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" async=""></script><script src="/_next/static/aoeL97fiGQMaunPBLLCoJ/_buildManifest.js" async=""></script><script src="/_next/static/aoeL97fiGQMaunPBLLCoJ/_ssgManifest.js" async=""></script></body></html>