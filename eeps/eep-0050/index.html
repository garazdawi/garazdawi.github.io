<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Erlang Programming Language</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"/><meta name="description" content="Erlang Programming Language"/><meta name="keywords" content="erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="alternate" type="application/rss+xml" title="Overall RSS 2.0 Feed" href="/rss"/><link rel="alternate" type="application/rss+xml" title="News RSS 2.0 Feed" href="/rss/news"/><link rel="alternate" type="application/rss+xml" title="Article RSS 2.0 Feed" href="/rss/articles"/><link rel="alternate" type="application/rss+xml" title="Events RSS 2.0 Feed" href="/rss/event"/><link rel="alternate" type="application/rss+xml" title="Downloads RSS 2.0 Feed" href="/rss/download"/><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><link rel="preload" href="/_next/static/css/4ee9685e1cc0da7f69f0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4ee9685e1cc0da7f69f0.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-290342a5f5c41b7caf9d.js" as="script"/><link rel="preload" href="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" as="script"/></head><body><div id="__next"><div class="navbar" style="background-color:#FFF;margin-bottom:0px"><div class="container"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse" style="position:absolute;right:5px;margin-bottom:0px"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="/img/erlang.png" width="60"/></a><div class="nav-collapse collapse navbar-responsive-collapse" style="padding:20px"><ul class="nav navbar-nav"><li><a class="menu-headlines" href="/downloads/"> DOWNLOADS </a></li><li><a class="menu-headlines" href="/docs/"> DOCUMENTATION </a></li><li><a class="menu-headlines" href="/community/"> COMMUNITY </a></li><li><a class="menu-headlines" href="/news/"> NEWS </a></li><li><a class="menu-headlines" href="/eeps/"> EEPS </a></li><li><a class="menu-headlines" href="/blog/"> BLOG </a></li><li><a class="menu-headlines" href="/about/"> ABOUT </a></li></ul></div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="static_div"><pre><code>Author: Jos√© Valim &lt;jose(dot)valim(at)gmail(dot)com&gt;
Status: Draft
Type: Standards Track
Created: 18-Sep-2019
Post-History:
</code></pre>

<hr />

<h2><a href="/eeps/eep-0000" title="EEP Index">EEP</a> 50: <a href="eep-0050.md" title="EEP Source"> Maps based set implementation</a></h2>

<h1>Abstract</h1>

<p>This EEP proposes a maps-based set implementation and a group of BIFs
with the goal of providing a <em>de facto</em> sets implementation in Erlang/OTP.</p>

<h1>Motivation</h1>

<p>In order to efficiently use sets in Erlang/OTP today, one has to
consider three different options:</p>

<ul>
<li><code>ordsets</code></li>
<li><code>gb_sets</code></li>
<li>using maps as sets (such as <code>cerl_sets</code>)</li>
</ul>

<p>For example, if you wish to perform unions/intersections/subtractions,
<code>ordsets</code> is generally the most efficient. For individual lookups,
<code>gb_sets</code> and "maps as sets" are preferred, although the latter has no
official API in Erlang/OTP. If you need a mixed profile, the best choice
becomes blurrier. Note there is also a <code>sets</code> module, but it is rarely a
viable option.</p>

<p>The current landscape with sets is not much different than the dictionary
landscape before Erlang/OTP 17. Luckily, once <code>maps</code> were added, <code>maps</code>
became the <em>de facto</em> dictionary in Erlang. The other dictionary-like
modules may perform better under limited occasions but <code>maps</code> provide
the best profile in many scenarios and are a reasonable starting point
(until a need for benchmarking and profiling arises - if it ever arises).</p>

<p>The goal of this EEP is to propose a map-based sets solution with a group
of BIFs that will give developers a sets implementation that can be
generally treated as the main set implementation in Erlang/OTP.</p>

<h1>Rationale</h1>

<p>Dictionaries and sets implementation tend to walk side-by-side. Such as
<code>ordsets</code> and <code>orddict</code>, <code>gb_trees</code> and <code>gb_sets</code>. That's because you can
consider elements in a set to be keys in a dictionary, where you don't care
about the value for the keys.</p>

<p>Given we have dictionaries implemented as maps, could we have sets based
on maps? The answer is yes and there are two approaches. The first approach
is to provide a native data structure, implemented in C, with its own
syntax.  The advantage of said approach would be lower memory usage,
but it has a large impact on the language and on the runtime. Therefore
that's not the approach we will pursue here.</p>

<p>The second approach, which this EEP advocates for, is to implement <code>sets</code>
on top of maps, as done by <code>cerl_sets</code>. In this scenario, the sets elements
are keys in the map and the values are empty lists (we chose empty lists
because they are very cheap to serialize).</p>

<p>Using "maps as sets" provide good performance characteristics today for
inserting, adding and deleting set elements, being faster than all other
implementations. However, in terms of memory usage, "maps as sets" use
almost two times more memory than <code>ordsets</code> (although note that the set
operations themselves may end-up using less memory). Compared to <code>gb_sets</code>,
"maps as sets" use less memory altogether.</p>

<p>But can "maps as sets" be as fast as <code>ordsets</code> for unions, intersections and
subtractions?</p>

<p>The good news is: <strong>this is already true for unions</strong>, which is equivalent
to <code>maps:merge/2</code>. Benchmarks are available in the addendum and we can take
the following conclusions:</p>

<ol>
<li><p>when unioning integers elements, maps and ordsets take roughly the same
time, with maps slightly ahead except in cases where we have to go from
small maps to large maps</p></li>
<li><p>when unioning tuples elements, maps are consistently faster, sometimes
2 to 4 times, except in cases where we have to go from small maps to
large maps. This is expected, the more expensive it becomes to compare
items, the more expensive <code>ordsets</code> become</p></li>
</ol>

<p>This means that, if we could implement intersection and subtraction on top
of maps, then it will likely be more efficient than ordsets, since
intersection and subtraction do not have the issue of map resizing.</p>

<p>A proof of concept was written for intersections using small and mixed maps
with positive results (see benchmarks in addendum). We can also see the new
intersections are consistently faster than <code>cerl_sets</code>. Unfortunately there
are no benchmarks for intersections between two large maps due to lack of C
expertise of this EEP author. The assumption, which should be verified, is
that intersecting large maps will be faster than intersecting large
<code>ordsets</code>.</p>

<p>Given the results seen in <code>maps:merge/2</code> and the fact that map resizing does
not happen on intersections, this assumption will likely turn out to be
true.</p>

<p>Therefore, if our goal is to make <code>maps</code> as fast as <code>ordsets</code> for those
operations, we need to implement new BIFs.</p>

<h1>Specification</h1>

<p>"maps as sets" are generally more efficient than the existing set
implementations for checking, adding and deleting elements. However,
they are slower than <code>ordsets</code> in the following operations:</p>

<ul>
<li><code>from_list/1</code></li>
<li><code>is_subset/2</code></li>
<li><code>is_disjoint/2</code></li>
<li><code>intersection/2</code></li>
<li><code>subtract/2</code></li>
</ul>

<p>Therefore, if we want to have a <em>de facto</em> set implementation, the functions
above would have to implemented as BIFs. The first three provide only
partial speed-ups compared to a pure Erlang implementation but the last two
operations with provide drastic gains as NIFs. The last two operations
are also the most complex to implement.</p>

<p>With the changes above, the only operations in "maps as sets" that won't be
as fast or faster than "ordsets" is <code>to_list</code> and <code>fold</code>, since <code>ordsets</code>
are lists internally.</p>

<p>Assuming the functionality above is validated as more performant (at least
for intersections and subtractions) and there is an interest in providing
said functionality, the last question is: how should this functionality be
exposed?</p>

<h1>Possible APIs for "maps as sets"</h1>

<h3>1. Augment the maps module</h3>

<p>If there is no interest in adding new module to OTP, the "maps" module could
be augmented to have set-based operations. In those cases, only the keys are
compared. The values can come from either the first or the second map.</p>

<p>While this approach will improve performance, the <code>intersection/2</code> and
<code>subtract/2</code> APIs in <code>maps</code> are quite awkward. One alternative is to prefix
those operations with the <code>key</code> prefix, such as <code>keyintersection</code>,
to make it clear they are about the intersection of keys. But perhaps
a better approach altogether is to define a separate module.</p>

<h3>2. Add <code>mapsets</code> module</h3>

<p>The <code>mapsets</code> module provide sets based on maps. The fact said sets are
based on maps is part of the public API (i.e. they are not an opaque type),
exactly like <code>ordsets</code>. The value for each key is the empty list to make
sure sets can be cheapily serialized.</p>

<p>This new module would have 5 BIFs:</p>

<ul>
<li><code>mapsets:from_list/1</code></li>
<li><code>mapsets:intersection/2</code></li>
<li><code>mapsets:is_subset/2</code></li>
<li><code>mapsets:is_disjoint/2</code></li>
<li><code>mapsets:subtract/2</code></li>
</ul>

<p>The remaining APIs would be implemented on top of the maps API.</p>

<h3>3. Change the <code>sets</code> module</h3>

<p>Another option, similar to the above, is to leverage the fact the <code>sets</code>
type is opaque and replace its implementation by "maps as sets". The
advantages of this approach is that everyone using <code>sets</code> today would get
a performance upgrade and we would avoid adding a new module to Erlang/OTP.
After all, there is always a risk that by adding a fourth option that
unifies all three existing options, we will simply end-up with four options.</p>

<p>The downside of this approach is that, although the <code>sets</code> datastructure is
opaque, developers may have serialized it elsewhere, and therefore the
existing data structure must still be supported. This means we would first
need to modify the <code>sets</code> module to support both old sets and the new
"maps as sets".  Support for the old data structure can be removed only
in future versions. We would also need to discuss an appropriate
migration path.</p>

<h1>Next Steps</h1>

<p>At the current stage, the proposal is a draft and not fully specified. In
particular, it is necessary to validate the implementation of some
operations and benchmark them. It is also necessary to choose a relevant
API for the propose functionality.</p>

<p>That said, if this proposal is viewed positively, the proposed next steps
are:</p>

<ol>
<li><p>Validate that intersections with maps is faster than with ordsets</p></li>
<li><p>Choose the desired API for "maps as sets" (i.e. choose between 1.
 extending <code>maps</code>, 2. adding <code>mapsets</code>, or 3. changing <code>sets</code>)</p></li>
<li><p>Implement the chosen API in Erlang (most of the <code>cerl_sets</code>
 implementation can be leveraged)</p></li>
<li><p>Optimize the relevant operations as BIFs</p></li>
</ol>

<p>The author of the EEP can help by implementating step 3.</p>

<h1>Copyright</h1>

<p>This document has been placed in the public domain.</p>

<p>[VimVar]: &lt;> " vim: set fileencoding=utf-8 expandtab shiftwidth=4
softtabstop=4: "</p>

<h1>Addendum: Union benchmark results</h1>

<h3>Unioning sets of integers</h3>

<pre><code>Operating System: macOS
CPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz
Number of Available Cores: 8
Available memory: 16 GB
Elixir 1.9.0
Erlang 23-master

Benchmark suite executing with the following configuration:
warmup: 2 s
time: 5 s
memory time: 0 ns
parallel: 1
Estimated total run time: 8.40 min

##### With input a1 Interspersed (5) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           4.18 M      239.50 ns ¬±13926.78%           0 ns
   1000 ns
3 ordsets:union        2.73 M      365.68 ns  ¬±8833.12%           0 ns
   1000 ns
2 gb_sets:union        0.99 M     1008.99 ns  ¬±2897.13%        1000 ns
   2000 ns

Comparison:
1 maps:merge           4.18 M
3 ordsets:union        2.73 M - 1.53x slower +126.19 ns
2 gb_sets:union        0.99 M - 4.21x slower +769.49 ns

##### With input a2 Interspersed (10) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           3.60 M      277.93 ns  ¬±9122.84%           0 ns
   1000 ns
3 ordsets:union        1.93 M      517.34 ns  ¬±5920.40%           0 ns
   1000 ns
2 gb_sets:union        0.62 M     1624.47 ns  ¬±2115.84%        1000 ns
   3000 ns

Comparison:
1 maps:merge           3.60 M
3 ordsets:union        1.93 M - 1.86x slower +239.41 ns
2 gb_sets:union        0.62 M - 5.84x slower +1346.54 ns

##### With input a3 Interspersed (30) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union     1012.27 K        0.99 Œºs  ¬±4048.88%           1 Œºs
      2 Œºs
1 maps:merge         318.99 K        3.13 Œºs   ¬±558.61%           3 Œºs
      7 Œºs
2 gb_sets:union      270.93 K        3.69 Œºs   ¬±222.80%           3 Œºs
     12 Œºs

Comparison:
3 ordsets:union     1012.27 K
1 maps:merge         318.99 K - 3.17x slower +2.15 Œºs
2 gb_sets:union      270.93 K - 3.74x slower +2.70 Œºs

##### With input a4 Interspersed (50) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge        1149.76 K        0.87 Œºs  ¬±3450.02%           1 Œºs
      2 Œºs
3 ordsets:union      584.09 K        1.71 Œºs  ¬±1716.00%           1 Œºs
      4 Œºs
2 gb_sets:union      146.62 K        6.82 Œºs   ¬±311.32%           6 Œºs
     25 Œºs

Comparison:
1 maps:merge        1149.76 K
3 ordsets:union      584.09 K - 1.97x slower +0.84 Œºs
2 gb_sets:union      146.62 K - 7.84x slower +5.95 Œºs

##### With input a5 Interspersed (1000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge          71.57 K       13.97 Œºs   ¬±154.74%          12 Œºs
     44 Œºs
3 ordsets:union       33.29 K       30.04 Œºs   ¬±134.28%          25 Œºs
     92 Œºs
2 gb_sets:union        8.36 K      119.56 Œºs    ¬±52.83%         106 Œºs
    255 Œºs

Comparison:
1 maps:merge          71.57 K
3 ordsets:union       33.29 K - 2.15x slower +16.07 Œºs
2 gb_sets:union        8.36 K - 8.56x slower +105.58 Œºs

##### With input a6 Interspersed (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           275.98        3.62 ms    ¬±36.94%        2.75 ms
   7.26 ms
3 ordsets:union        247.19        4.05 ms    ¬±14.63%        4.01 ms
   5.39 ms
2 gb_sets:union         43.70       22.88 ms    ¬±28.56%       20.66 ms
  44.84 ms

Comparison:
1 maps:merge           275.98
3 ordsets:union        247.19 - 1.12x slower +0.42 ms
2 gb_sets:union         43.70 - 6.32x slower +19.26 ms

##### With input b1 Half-left (5) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union        5.14 M      194.71 ns  ¬±2814.44%           0 ns
   1000 ns
1 maps:merge           4.80 M      208.36 ns ¬±20621.17%           0 ns
   1000 ns
2 gb_sets:union        1.48 M      673.48 ns  ¬±4924.77%        1000 ns
   1000 ns

Comparison:
3 ordsets:union        5.14 M
1 maps:merge           4.80 M - 1.07x slower +13.65 ns
2 gb_sets:union        1.48 M - 3.46x slower +478.77 ns

##### With input b2 Half-left (10) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           4.42 M      226.29 ns  ¬±9473.44%           0 ns
   1000 ns
3 ordsets:union        3.73 M      268.01 ns ¬±12800.39%           0 ns
   1000 ns
2 gb_sets:union        0.87 M     1144.30 ns  ¬±2389.89%        1000 ns
   2000 ns

Comparison:
1 maps:merge           4.42 M
3 ordsets:union        3.73 M - 1.18x slower +41.72 ns
2 gb_sets:union        0.87 M - 5.06x slower +918.01 ns

##### With input b3 Half-left (30) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           2.64 M      378.92 ns ¬±12298.14%           0 ns
   1000 ns
3 ordsets:union        1.70 M      589.31 ns  ¬±7472.62%           0 ns
   1000 ns
2 gb_sets:union        0.43 M     2326.42 ns   ¬±393.28%        2000 ns
   4000 ns

Comparison:
1 maps:merge           2.64 M
3 ordsets:union        1.70 M - 1.56x slower +210.39 ns
2 gb_sets:union        0.43 M - 6.14x slower +1947.49 ns

##### With input b4 Half-left (50) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union     1365.15 K        0.73 Œºs  ¬±3249.86%           1 Œºs
      1 Œºs
1 maps:merge         587.14 K        1.70 Œºs  ¬±1709.70%           1 Œºs
      3 Œºs
2 gb_sets:union      254.37 K        3.93 Œºs   ¬±510.57%           3 Œºs
     16 Œºs

Comparison:
3 ordsets:union     1365.15 K
1 maps:merge         587.14 K - 2.33x slower +0.97 Œºs
2 gb_sets:union      254.37 K - 5.37x slower +3.20 Œºs

##### With input b5 Half-left (1000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge         130.95 K        7.64 Œºs    ¬±44.63%           7 Œºs
     25 Œºs
3 ordsets:union      112.42 K        8.90 Œºs   ¬±271.51%           8 Œºs
     34 Œºs
2 gb_sets:union       14.89 K       67.17 Œºs    ¬±81.58%          58 Œºs
 167.75 Œºs

Comparison:
1 maps:merge         130.95 K
3 ordsets:union      112.42 K - 1.16x slower +1.26 Œºs
2 gb_sets:union       14.89 K - 8.80x slower +59.54 Œºs

##### With input b6 Half-left (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           736.54        1.36 ms    ¬±13.50%        1.30 ms
   2.17 ms
3 ordsets:union        424.33        2.36 ms    ¬±20.47%        2.28 ms
   3.81 ms
2 gb_sets:union        111.06        9.00 ms    ¬±14.00%        8.64 ms
  14.87 ms

Comparison:
1 maps:merge           736.54
3 ordsets:union        424.33 - 1.74x slower +1.00 ms
2 gb_sets:union        111.06 - 6.63x slower +7.65 ms

##### With input c1 Half-right (5) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union        5.39 M      185.61 ns  ¬±3347.98%           0 ns
   1000 ns
1 maps:merge           4.44 M      224.99 ns ¬±18210.87%           0 ns
   1000 ns
2 gb_sets:union        1.38 M      726.62 ns  ¬±5484.65%        1000 ns
   2000 ns

Comparison:
3 ordsets:union        5.39 M
1 maps:merge           4.44 M - 1.21x slower +39.37 ns
2 gb_sets:union        1.38 M - 3.91x slower +541.01 ns

##### With input c2 Half-right (10) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           4.50 M      222.20 ns  ¬±6200.17%           0 ns
   1000 ns
3 ordsets:union        3.66 M      273.47 ns ¬±11368.54%           0 ns
   1000 ns
2 gb_sets:union        0.91 M     1097.73 ns  ¬±2497.65%        1000 ns
   2000 ns

Comparison:
1 maps:merge           4.50 M
3 ordsets:union        3.66 M - 1.23x slower +51.26 ns
2 gb_sets:union        0.91 M - 4.94x slower +875.52 ns

##### With input c3 Half-right (30) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           2.88 M      346.75 ns ¬±11287.26%           0 ns
   1000 ns
3 ordsets:union        1.87 M      534.45 ns  ¬±5864.66%           0 ns
   1000 ns
2 gb_sets:union        0.42 M     2353.46 ns   ¬±409.72%        2000 ns
   5000 ns

Comparison:
1 maps:merge           2.88 M
3 ordsets:union        1.87 M - 1.54x slower +187.69 ns
2 gb_sets:union        0.42 M - 6.79x slower +2006.70 ns

##### With input c4 Half-right (50) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union     1405.29 K        0.71 Œºs  ¬±4860.25%           1 Œºs
      2 Œºs
1 maps:merge         541.91 K        1.85 Œºs  ¬±1461.20%           2 Œºs
      3 Œºs
2 gb_sets:union      248.12 K        4.03 Œºs   ¬±526.17%           3 Œºs
     17 Œºs

Comparison:
3 ordsets:union     1405.29 K
1 maps:merge         541.91 K - 2.59x slower +1.13 Œºs
2 gb_sets:union      248.12 K - 5.66x slower +3.32 Œºs

##### With input c5 Half-right (1000) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union      117.05 K        8.54 Œºs   ¬±180.01%           8 Œºs
     32 Œºs
1 maps:merge         106.28 K        9.41 Œºs   ¬±706.19%           8 Œºs
     28 Œºs
2 gb_sets:union       14.62 K       68.38 Œºs    ¬±69.45%          59 Œºs
    149 Œºs

Comparison:
3 ordsets:union      117.05 K
1 maps:merge         106.28 K - 1.10x slower +0.87 Œºs
2 gb_sets:union       14.62 K - 8.00x slower +59.84 Œºs

##### With input c6 Half-right (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           447.90        2.23 ms    ¬±42.50%        1.81 ms
   6.07 ms
3 ordsets:union        312.45        3.20 ms    ¬±35.75%        2.92 ms
   7.20 ms
2 gb_sets:union        110.13        9.08 ms    ¬±14.75%        8.72 ms
  16.01 ms

Comparison:
1 maps:merge           447.90
3 ordsets:union        312.45 - 1.43x slower +0.97 ms
2 gb_sets:union        110.13 - 4.07x slower +6.85 ms

##### With input d1 Equal (5) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           4.03 M      248.00 ns ¬±13008.64%           0 ns
   1000 ns
3 ordsets:union        3.41 M      293.08 ns ¬±11881.46%           0 ns
   1000 ns
2 gb_sets:union        1.34 M      748.45 ns  ¬±5426.61%        1000 ns
   2000 ns

Comparison:
1 maps:merge           4.03 M
3 ordsets:union        3.41 M - 1.18x slower +45.08 ns
2 gb_sets:union        1.34 M - 3.02x slower +500.44 ns

##### With input d2 Equal (10) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union        3.33 M      300.31 ns  ¬±5298.85%           0 ns
   1000 ns
1 maps:merge           2.81 M      355.61 ns ¬±14326.68%           0 ns
   1000 ns
2 gb_sets:union        0.75 M     1337.84 ns  ¬±2488.47%        1000 ns
   4000 ns

Comparison:
3 ordsets:union        3.33 M
1 maps:merge           2.81 M - 1.18x slower +55.30 ns
2 gb_sets:union        0.75 M - 4.45x slower +1037.53 ns

##### With input d3 Equal (30) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           2.25 M      443.46 ns  ¬±8688.55%           0 ns
   1000 ns
3 ordsets:union        1.46 M      683.82 ns  ¬±3817.58%        1000 ns
   1000 ns
2 gb_sets:union        0.37 M     2686.18 ns   ¬±483.99%        2000 ns
   9000 ns

Comparison:
1 maps:merge           2.25 M
3 ordsets:union        1.46 M - 1.54x slower +240.36 ns
2 gb_sets:union        0.37 M - 6.06x slower +2242.72 ns

##### With input d4 Equal (50) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           1.50 M      668.83 ns   ¬±132.24%        1000 ns
   1000 ns
3 ordsets:union        1.04 M      960.02 ns  ¬±4458.67%        1000 ns
   2000 ns
2 gb_sets:union        0.22 M     4523.49 ns   ¬±196.98%        4000 ns
  18000 ns

Comparison:
1 maps:merge           1.50 M
3 ordsets:union        1.04 M - 1.44x slower +291.19 ns
2 gb_sets:union        0.22 M - 6.76x slower +3854.66 ns

##### With input d5 Equal (1000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge          81.92 K       12.21 Œºs    ¬±57.31%          11 Œºs
     32 Œºs
3 ordsets:union       77.39 K       12.92 Œºs   ¬±129.75%          12 Œºs
     39 Œºs
2 gb_sets:union       12.72 K       78.63 Œºs    ¬±43.08%          70 Œºs
    174 Œºs

Comparison:
1 maps:merge          81.92 K
3 ordsets:union       77.39 K - 1.06x slower +0.71 Œºs
2 gb_sets:union       12.72 K - 6.44x slower +66.43 Œºs

##### With input d6 Equal (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           646.20        1.55 ms    ¬±18.21%        1.45 ms
   2.86 ms
3 ordsets:union        305.88        3.27 ms    ¬±16.73%        3.22 ms
   4.79 ms
2 gb_sets:union         96.06       10.41 ms    ¬±18.09%        9.72 ms
  17.41 ms

Comparison:
1 maps:merge           646.20
3 ordsets:union        305.88 - 2.11x slower +1.72 ms
2 gb_sets:union         96.06 - 6.73x slower +8.86 ms
</code></pre>

<h3>Unioning sets of tuple-integers</h3>

<pre><code>Operating System: macOS
CPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz
Number of Available Cores: 8
Available memory: 16 GB
Elixir 1.9.0
Erlang 23-master

Benchmark suite executing with the following configuration:
warmup: 2 s
time: 5 s
memory time: 0 ns
parallel: 1
Estimated total run time: 8.40 min

##### With input a1 Interspersed (5) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           2.93 M      341.36 ns  ¬±2603.07%           0 ns
   1000 ns
3 ordsets:union        1.62 M      616.04 ns  ¬±4989.81%           0 ns
   1000 ns
2 gb_sets:union        0.82 M     1219.38 ns  ¬±2533.38%        1000 ns
   2000 ns

Comparison:
1 maps:merge           2.93 M
3 ordsets:union        1.62 M - 1.80x slower +274.68 ns
2 gb_sets:union        0.82 M - 3.57x slower +878.02 ns

##### With input a2 Interspersed (10) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           2.02 M      494.89 ns  ¬±2798.11%           0 ns
   1000 ns
3 ordsets:union        1.04 M      963.72 ns  ¬±2195.45%        1000 ns
   2000 ns
2 gb_sets:union        0.50 M     2012.64 ns  ¬±1226.89%        2000 ns
   4000 ns

Comparison:
1 maps:merge           2.02 M
3 ordsets:union        1.04 M - 1.95x slower +468.83 ns
2 gb_sets:union        0.50 M - 4.07x slower +1517.75 ns

##### With input a3 Interspersed (30) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union      408.22 K        2.45 Œºs   ¬±828.38%           2 Œºs
      4 Œºs
1 maps:merge         234.27 K        4.27 Œºs   ¬±330.95%           4 Œºs
     10 Œºs
2 gb_sets:union      189.97 K        5.26 Œºs   ¬±643.32%           5 Œºs
     18 Œºs

Comparison:
3 ordsets:union      408.22 K
1 maps:merge         234.27 K - 1.74x slower +1.82 Œºs
2 gb_sets:union      189.97 K - 2.15x slower +2.81 Œºs

##### With input a4 Interspersed (50) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge         767.56 K        1.30 Œºs  ¬±1279.19%           1 Œºs
      2 Œºs
3 ordsets:union      246.12 K        4.06 Œºs   ¬±267.03%           4 Œºs
     14 Œºs
2 gb_sets:union      108.33 K        9.23 Œºs   ¬±255.73%           8 Œºs
     27 Œºs

Comparison:
1 maps:merge         767.56 K
3 ordsets:union      246.12 K - 3.12x slower +2.76 Œºs
2 gb_sets:union      108.33 K - 7.09x slower +7.93 Œºs

##### With input a5 Interspersed (1000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge          47.61 K       21.00 Œºs   ¬±196.69%          19 Œºs
     59 Œºs
3 ordsets:union       12.38 K       80.76 Œºs    ¬±53.12%          73 Œºs
    193 Œºs
2 gb_sets:union        6.04 K      165.68 Œºs    ¬±30.74%         152 Œºs
    309 Œºs

Comparison:
1 maps:merge          47.61 K
3 ordsets:union       12.38 K - 3.84x slower +59.75 Œºs
2 gb_sets:union        6.04 K - 7.89x slower +144.67 Œºs

##### With input a6 Interspersed (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           210.63        4.75 ms    ¬±35.35%        3.77 ms
   9.58 ms
3 ordsets:union         74.84       13.36 ms    ¬±17.83%       12.73 ms
  18.51 ms
2 gb_sets:union         54.06       18.50 ms    ¬±14.28%       17.83 ms
  24.21 ms

Comparison:
1 maps:merge           210.63
3 ordsets:union         74.84 - 2.81x slower +8.61 ms
2 gb_sets:union         54.06 - 3.90x slower +13.75 ms

##### With input b1 Half-left (5) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           4.49 M      222.57 ns  ¬±1774.31%           0 ns
   1000 ns
3 ordsets:union        3.33 M      300.45 ns  ¬±6349.54%           0 ns
   1000 ns
2 gb_sets:union        1.46 M      683.85 ns  ¬±2344.50%        1000 ns
   1000 ns

Comparison:
1 maps:merge           4.49 M
3 ordsets:union        3.33 M - 1.35x slower +77.88 ns
2 gb_sets:union        1.46 M - 3.07x slower +461.29 ns

##### With input b2 Half-left (10) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           2.48 M      402.60 ns  ¬±9495.69%           0 ns
   1000 ns
3 ordsets:union        2.30 M      435.32 ns  ¬±1123.50%           0 ns
   1000 ns
2 gb_sets:union        0.76 M     1318.82 ns   ¬±818.75%        1000 ns
   2000 ns

Comparison:
1 maps:merge           2.48 M
3 ordsets:union        2.30 M - 1.08x slower +32.73 ns
2 gb_sets:union        0.76 M - 3.28x slower +916.23 ns

##### With input b3 Half-left (30) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           1.54 M      648.33 ns  ¬±2884.79%           0 ns
   1000 ns
3 ordsets:union        1.09 M      921.12 ns   ¬±734.80%        1000 ns
   2000 ns
2 gb_sets:union        0.37 M     2728.75 ns   ¬±554.08%        2000 ns
   6000 ns

Comparison:
1 maps:merge           1.54 M
3 ordsets:union        1.09 M - 1.42x slower +272.79 ns
2 gb_sets:union        0.37 M - 4.21x slower +2080.42 ns

##### With input b4 Half-left (50) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union      734.80 K        1.36 Œºs   ¬±978.11%           1 Œºs
      3 Œºs
1 maps:merge         439.62 K        2.27 Œºs  ¬±1429.61%           2 Œºs
      5 Œºs
2 gb_sets:union      224.47 K        4.45 Œºs   ¬±213.29%           4 Œºs
     15 Œºs

Comparison:
3 ordsets:union      734.80 K
1 maps:merge         439.62 K - 1.67x slower +0.91 Œºs
2 gb_sets:union      224.47 K - 3.27x slower +3.09 Œºs

##### With input b5 Half-left (1000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge          76.01 K       13.16 Œºs   ¬±104.36%          12 Œºs
     35 Œºs
3 ordsets:union       45.29 K       22.08 Œºs   ¬±125.57%          20 Œºs
     60 Œºs
2 gb_sets:union       13.42 K       74.53 Œºs    ¬±44.00%          68 Œºs
    164 Œºs

Comparison:
1 maps:merge          76.01 K
3 ordsets:union       45.29 K - 1.68x slower +8.93 Œºs
2 gb_sets:union       13.42 K - 5.66x slower +61.37 Œºs

##### With input b6 Half-left (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           530.32        1.89 ms    ¬±18.53%        1.77 ms
   3.40 ms
3 ordsets:union        139.97        7.14 ms    ¬±17.91%        7.01 ms
  11.23 ms
2 gb_sets:union         91.51       10.93 ms    ¬±12.31%       10.34 ms
  15.62 ms

Comparison:
1 maps:merge           530.32
3 ordsets:union        139.97 - 3.79x slower +5.26 ms
2 gb_sets:union         91.51 - 5.80x slower +9.04 ms

##### With input c1 Half-right (5) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           4.46 M      224.32 ns  ¬±1730.97%           0 ns
   1000 ns
3 ordsets:union        3.78 M      264.68 ns  ¬±3293.90%           0 ns
   1000 ns
2 gb_sets:union        1.52 M      658.44 ns  ¬±1819.22%        1000 ns
   1000 ns

Comparison:
1 maps:merge           4.46 M
3 ordsets:union        3.78 M - 1.18x slower +40.37 ns
2 gb_sets:union        1.52 M - 2.94x slower +434.13 ns

##### With input c2 Half-right (10) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union        2.36 M      424.51 ns  ¬±2870.39%           0 ns
   1000 ns
1 maps:merge           2.27 M      441.04 ns ¬±11548.99%           0 ns
   1000 ns
2 gb_sets:union        0.80 M     1248.21 ns   ¬±948.08%        1000 ns
   2000 ns

Comparison:
3 ordsets:union        2.36 M
1 maps:merge           2.27 M - 1.04x slower +16.53 ns
2 gb_sets:union        0.80 M - 2.94x slower +823.70 ns

##### With input c3 Half-right (30) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           1.53 M      654.58 ns  ¬±2879.82%        1000 ns
   1000 ns
3 ordsets:union        1.13 M      885.52 ns  ¬±2213.29%        1000 ns
   2000 ns
2 gb_sets:union        0.37 M     2675.20 ns   ¬±502.40%        2000 ns
   5000 ns

Comparison:
1 maps:merge           1.53 M
3 ordsets:union        1.13 M - 1.35x slower +230.94 ns
2 gb_sets:union        0.37 M - 4.09x slower +2020.62 ns

##### With input c4 Half-right (50) #####
Name                      ips        average  deviation         median
    99th %
3 ordsets:union      747.48 K        1.34 Œºs  ¬±1222.85%           1 Œºs
      3 Œºs
1 maps:merge         433.42 K        2.31 Œºs  ¬±1493.25%           2 Œºs
      4 Œºs
2 gb_sets:union      223.83 K        4.47 Œºs   ¬±283.66%           4 Œºs
     13 Œºs

Comparison:
3 ordsets:union      747.48 K
1 maps:merge         433.42 K - 1.72x slower +0.97 Œºs
2 gb_sets:union      223.83 K - 3.34x slower +3.13 Œºs

##### With input c5 Half-right (1000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge          66.00 K       15.15 Œºs   ¬±321.69%          14 Œºs
     41 Œºs
3 ordsets:union       44.62 K       22.41 Œºs   ¬±767.12%          20 Œºs
     60 Œºs
2 gb_sets:union       13.20 K       75.74 Œºs    ¬±41.33%          70 Œºs
    161 Œºs

Comparison:
1 maps:merge          66.00 K
3 ordsets:union       44.62 K - 1.48x slower +7.26 Œºs
2 gb_sets:union       13.20 K - 5.00x slower +60.59 Œºs

##### With input c6 Half-right (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           428.32        2.33 ms    ¬±28.88%        2.06 ms
   4.05 ms
3 ordsets:union        146.62        6.82 ms    ¬±18.71%        6.60 ms
  10.79 ms
2 gb_sets:union         91.45       10.93 ms    ¬±13.58%       10.27 ms
  15.80 ms

Comparison:
1 maps:merge           428.32
3 ordsets:union        146.62 - 2.92x slower +4.49 ms
2 gb_sets:union         91.45 - 4.68x slower +8.60 ms

##### With input d1 Equal (5) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           3.61 M      276.63 ns  ¬±3338.58%           0 ns
   1000 ns
3 ordsets:union        2.42 M      414.07 ns  ¬±3326.82%           0 ns
   1000 ns
2 gb_sets:union        1.26 M      792.13 ns  ¬±1546.56%        1000 ns
   2000 ns

Comparison:
1 maps:merge           3.61 M
3 ordsets:union        2.42 M - 1.50x slower +137.45 ns
2 gb_sets:union        1.26 M - 2.86x slower +515.50 ns

##### With input d2 Equal (10) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           2.15 M      464.77 ns  ¬±8475.08%           0 ns
   1000 ns
3 ordsets:union        1.88 M      531.65 ns   ¬±493.39%        1000 ns
   1000 ns
2 gb_sets:union        0.69 M     1459.20 ns  ¬±1113.96%        1000 ns
   3000 ns

Comparison:
1 maps:merge           2.15 M
3 ordsets:union        1.88 M - 1.14x slower +66.89 ns
2 gb_sets:union        0.69 M - 3.14x slower +994.43 ns

##### With input d3 Equal (30) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge        1364.57 K        0.73 Œºs  ¬±4056.53%           1 Œºs
      1 Œºs
3 ordsets:union      742.74 K        1.35 Œºs  ¬±1193.06%           1 Œºs
      2 Œºs
2 gb_sets:union      307.17 K        3.26 Œºs   ¬±527.79%           3 Œºs
      8 Œºs

Comparison:
1 maps:merge        1364.57 K
3 ordsets:union      742.74 K - 1.84x slower +0.61 Œºs
2 gb_sets:union      307.17 K - 4.44x slower +2.52 Œºs

##### With input d4 Equal (50) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge         816.34 K        1.22 Œºs   ¬±168.59%           1 Œºs
      2 Œºs
3 ordsets:union      451.06 K        2.22 Œºs  ¬±1119.27%           2 Œºs
      4 Œºs
2 gb_sets:union      184.50 K        5.42 Œºs   ¬±200.77%           5 Œºs
     19 Œºs

Comparison:
1 maps:merge         816.34 K
3 ordsets:union      451.06 K - 1.81x slower +0.99 Œºs
2 gb_sets:union      184.50 K - 4.42x slower +4.19 Œºs

##### With input d5 Equal (1000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge          46.22 K       21.63 Œºs    ¬±39.65%          20 Œºs
     53 Œºs
3 ordsets:union       26.20 K       38.17 Œºs    ¬±63.50%          35 Œºs
    101 Œºs
2 gb_sets:union       10.24 K       97.66 Œºs    ¬±36.11%          90 Œºs
    199 Œºs

Comparison:
1 maps:merge          46.22 K
3 ordsets:union       26.20 K - 1.76x slower +16.53 Œºs
2 gb_sets:union       10.24 K - 4.51x slower +76.03 Œºs

##### With input d6 Equal (100000) #####
Name                      ips        average  deviation         median
    99th %
1 maps:merge           440.81        2.27 ms    ¬±12.79%        2.17 ms
   3.48 ms
3 ordsets:union        126.12        7.93 ms    ¬±26.40%        7.11 ms
  13.85 ms
2 gb_sets:union         73.86       13.54 ms    ¬±18.78%       12.89 ms
  19.27 ms

Comparison:
1 maps:merge           440.81
3 ordsets:union        126.12 - 3.50x slower +5.66 ms
2 gb_sets:union         73.86 - 5.97x slower +11.27 ms
</code></pre>

<h1>Addendum: Intersection benchmark results</h1>

<h3>Intersection of sets of integers</h3>

<pre><code>Operating System: macOS
CPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz
Number of Available Cores: 8
Available memory: 16 GB
Elixir 1.9.0
Erlang 23-master

Benchmark suite executing with the following configuration:
warmup: 2 s
time: 5 s
memory time: 0 ns
parallel: 1
Estimated total run time: 6.53 min

##### With input a1 Interspersed (5) #####
Name                               ips        average  deviation   median       99th %
1 mapsets:intersection          5.64 M      177.31 ns  ¬±8960.73%     0 ns      1000 ns
3 ordsets:intersection          4.58 M      218.18 ns  ¬±1955.05%     0 ns      1000 ns
2 gb_sets:intersection          1.85 M      541.24 ns  ¬±3690.38%     0 ns      1000 ns
0 cerl_sets:intersection        1.81 M      551.00 ns  ¬±6378.03%     0 ns      1000 ns

Comparison:
1 mapsets:intersection          5.64 M
3 ordsets:intersection          4.58 M - 1.23x slower +40.87 ns
2 gb_sets:intersection          1.85 M - 3.05x slower +363.93 ns
0 cerl_sets:intersection        1.81 M - 3.11x slower +373.69 ns

##### With input a2 Interspersed (10) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          3.87 M      258.37 ns  ¬±8156.88%     0 ns     1000 ns
3 ordsets:intersection          3.25 M      307.69 ns   ¬±995.12%     0 ns     1000 ns
0 cerl_sets:intersection        1.35 M      742.45 ns  ¬±4916.42%  1000 ns     1000 ns
2 gb_sets:intersection          1.20 M      833.71 ns  ¬±3535.59%  1000 ns     1000 ns

Comparison:
1 mapsets:intersection          3.87 M
3 ordsets:intersection          3.25 M - 1.19x slower +49.32 ns
0 cerl_sets:intersection        1.35 M - 2.87x slower +484.09 ns
2 gb_sets:intersection          1.20 M - 3.23x slower +575.34 ns

##### With input a3 Interspersed (30) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          2.37 M        0.42 Œºs  ¬±7530.28%     0 Œºs        1 Œºs
3 ordsets:intersection          1.57 M        0.64 Œºs   ¬±571.54%     1 Œºs        1 Œºs
0 cerl_sets:intersection        0.63 M        1.60 Œºs  ¬±1704.57%     1 Œºs        3 Œºs
2 gb_sets:intersection          0.57 M        1.74 Œºs  ¬±1508.42%     2 Œºs        3 Œºs

Comparison:
1 mapsets:intersection          2.37 M
3 ordsets:intersection          1.57 M - 1.51x slower +0.21 Œºs
0 cerl_sets:intersection        0.63 M - 3.79x slower +1.17 Œºs
2 gb_sets:intersection          0.57 M - 4.13x slower +1.32 Œºs

##### With input b1 Half-left (5) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          7.81 M      128.06 ns  ¬±3031.39%     0 ns     1000 ns
3 ordsets:intersection          6.10 M      163.95 ns   ¬±819.87%     0 ns     1000 ns
2 gb_sets:intersection          1.91 M      524.17 ns  ¬±3574.70%     0 ns     1000 ns
0 cerl_sets:intersection        1.73 M      578.18 ns  ¬±5060.91%     0 ns     1000 ns

Comparison:
1 mapsets:intersection          7.81 M
3 ordsets:intersection          6.10 M - 1.28x slower +35.89 ns
2 gb_sets:intersection          1.91 M - 4.09x slower +396.11 ns
0 cerl_sets:intersection        1.73 M - 4.51x slower +450.12 ns

##### With input b2 Half-left (10) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          5.34 M      187.35 ns  ¬±6435.27%     0 ns     1000 ns
3 ordsets:intersection          3.50 M      285.53 ns  ¬±8907.47%     0 ns     1000 ns
0 cerl_sets:intersection        1.25 M      801.68 ns  ¬±2618.59%  1000 ns     1000 ns
2 gb_sets:intersection          1.15 M      865.97 ns  ¬±3771.19%  1000 ns     1000 ns

Comparison:
1 mapsets:intersection          5.34 M
3 ordsets:intersection          3.50 M - 1.52x slower +98.18 ns
0 cerl_sets:intersection        1.25 M - 4.28x slower +614.33 ns
2 gb_sets:intersection          1.15 M - 4.62x slower +678.63 ns

##### With input b3 Half-left (30) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          3.12 M        0.32 Œºs ¬±10505.28%     0 Œºs        1 Œºs
3 ordsets:intersection          1.79 M        0.56 Œºs  ¬±5943.47%     0 Œºs        1 Œºs
0 cerl_sets:intersection        0.60 M        1.66 Œºs  ¬±1650.01%     1 Œºs        3 Œºs
2 gb_sets:intersection          0.57 M        1.77 Œºs  ¬±1510.44%     2 Œºs        3 Œºs

Comparison:
1 mapsets:intersection          3.12 M
3 ordsets:intersection          1.79 M - 1.74x slower +0.24 Œºs
0 cerl_sets:intersection        0.60 M - 5.17x slower +1.34 Œºs
2 gb_sets:intersection          0.57 M - 5.51x slower +1.45 Œºs

##### With input b4 Half-left (50) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          1.41 M        0.71 Œºs  ¬±4451.88%     1 Œºs        1 Œºs
3 ordsets:intersection          1.32 M        0.76 Œºs  ¬±4422.37%     1 Œºs        1 Œºs
2 gb_sets:intersection          0.37 M        2.72 Œºs   ¬±719.29%     2 Œºs        5 Œºs
0 cerl_sets:intersection        0.31 M        3.26 Œºs   ¬±464.70%     3 Œºs        5 Œºs

Comparison:
1 mapsets:intersection          1.41 M
3 ordsets:intersection          1.32 M - 1.07x slower +0.0487 Œºs
2 gb_sets:intersection          0.37 M - 3.82x slower +2.01 Œºs
0 cerl_sets:intersection        0.31 M - 4.59x slower +2.55 Œºs

##### With input c1 Halt-right (5) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          8.50 M      117.64 ns  ¬±3751.50%     0 ns     1000 ns
3 ordsets:intersection          4.96 M      201.70 ns  ¬±1008.33%     0 ns     1000 ns
0 cerl_sets:intersection        2.66 M      375.86 ns  ¬±7893.27%     0 ns     1000 ns
2 gb_sets:intersection          1.99 M      501.60 ns  ¬±5740.59%     0 ns     1000 ns

Comparison:
1 mapsets:intersection          8.50 M
3 ordsets:intersection          4.96 M - 1.71x slower +84.06 ns
0 cerl_sets:intersection        2.66 M - 3.20x slower +258.22 ns
2 gb_sets:intersection          1.99 M - 4.26x slower +383.96 ns

##### With input c2 Halt-right (10) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          5.61 M      178.32 ns  ¬±6353.45%     0 ns     1000 ns
3 ordsets:intersection          3.27 M      305.53 ns  ¬±8831.03%     0 ns     1000 ns
0 cerl_sets:intersection        1.61 M      619.53 ns  ¬±5512.50%     0 ns     1000 ns
2 gb_sets:intersection          1.20 M      830.39 ns  ¬±3587.38%  1000 ns     1000 ns

Comparison:
1 mapsets:intersection          5.61 M
3 ordsets:intersection          3.27 M - 1.71x slower +127.21 ns
0 cerl_sets:intersection        1.61 M - 3.47x slower +441.21 ns
2 gb_sets:intersection          1.20 M - 4.66x slower +652.07 ns

##### With input c3 Halt-right (30) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          3.02 M        0.33 Œºs ¬±10877.75%     0 Œºs        1 Œºs
3 ordsets:intersection          1.76 M        0.57 Œºs  ¬±6736.07%     0 Œºs        1 Œºs
0 cerl_sets:intersection        0.83 M        1.20 Œºs  ¬±2066.14%     1 Œºs        2 Œºs
2 gb_sets:intersection          0.56 M        1.80 Œºs  ¬±1442.53%     2 Œºs        3 Œºs

Comparison:
1 mapsets:intersection          3.02 M
3 ordsets:intersection          1.76 M - 1.71x slower +0.24 Œºs
0 cerl_sets:intersection        0.83 M - 3.61x slower +0.87 Œºs
2 gb_sets:intersection          0.56 M - 5.41x slower +1.46 Œºs

##### With input c4 Half-right (50) #####
Name                               ips        average  deviation   median      99th %
3 ordsets:intersection          1.42 M        0.70 Œºs  ¬±4101.38%     1 Œºs        1 Œºs
1 mapsets:intersection          1.31 M        0.77 Œºs  ¬±5155.14%     1 Œºs        1 Œºs
0 cerl_sets:intersection        0.48 M        2.07 Œºs  ¬±1105.13%     2 Œºs        3 Œºs
2 gb_sets:intersection          0.37 M        2.69 Œºs   ¬±793.20%     2 Œºs        5 Œºs

Comparison:
3 ordsets:intersection          1.42 M
1 mapsets:intersection          1.31 M - 1.09x slower +0.0618 Œºs
0 cerl_sets:intersection        0.48 M - 2.95x slower +1.37 Œºs
2 gb_sets:intersection          0.37 M - 3.82x slower +1.98 Œºs

##### With input d1 Equal (5) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          4.61 M      216.84 ns  ¬±4985.98%     0 ns     1000 ns
3 ordsets:intersection          3.44 M      290.38 ns  ¬±9494.06%     0 ns     1000 ns
0 cerl_sets:intersection        1.62 M      618.37 ns  ¬±5703.54%     0 ns     1000 ns
2 gb_sets:intersection          1.48 M      677.41 ns  ¬±4388.76%  1000 ns     1000 ns

Comparison:
1 mapsets:intersection          4.61 M
3 ordsets:intersection          3.44 M - 1.34x slower +73.54 ns
0 cerl_sets:intersection        1.62 M - 2.85x slower +401.53 ns
2 gb_sets:intersection          1.48 M - 3.12x slower +460.57 ns

##### With input d2 Equal (10) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          3.96 M      252.22 ns ¬±10397.76%     0 ns     1000 ns
3 ordsets:intersection          2.95 M      338.84 ns  ¬±8900.72%     0 ns     1000 ns
0 cerl_sets:intersection        1.16 M      862.62 ns  ¬±3981.08%  1000 ns     1000 ns
2 gb_sets:intersection          0.90 M     1112.16 ns  ¬±2553.42%  1000 ns     2000 ns

Comparison:
1 mapsets:intersection          3.96 M
3 ordsets:intersection          2.95 M - 1.34x slower +86.61 ns
0 cerl_sets:intersection        1.16 M - 3.42x slower +610.40 ns
2 gb_sets:intersection          0.90 M - 4.41x slower +859.94 ns

##### With input d3 Equal (30) #####
Name                               ips        average  deviation   median      99th %
1 mapsets:intersection          2.31 M        0.43 Œºs  ¬±8998.97%     0 Œºs        1 Œºs
3 ordsets:intersection          1.49 M        0.67 Œºs  ¬±3628.66%     1 Œºs        1 Œºs
0 cerl_sets:intersection        0.52 M        1.94 Œºs   ¬±965.82%     2 Œºs        3 Œºs
2 gb_sets:intersection          0.42 M        2.38 Œºs   ¬±878.07%     2 Œºs        4 Œºs

Comparison:
1 mapsets:intersection          2.31 M
3 ordsets:intersection          1.49 M - 1.55x slower +0.24 Œºs
0 cerl_sets:intersection        0.52 M - 4.48x slower +1.51 Œºs
2 gb_sets:intersection          0.42 M - 5.50x slower +1.95 Œºs
</code></pre>

<h3>Unioning sets of tuple-integers</h3>

<pre><code>Operating System: macOS
CPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz
Number of Available Cores: 8
Available memory: 16 GB
Elixir 1.9.0
Erlang 23-master

Benchmark suite executing with the following configuration:
warmup: 2 s
time: 5 s
memory time: 0 ns
parallel: 1
Estimated total run time: 4.90 min

##### With input a1 Interspersed (5) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        2.53 M      394.70 ns  ¬±7692.39%     0 ns       1000 ns
3 ordsets:intersection        2.12 M      471.60 ns  ¬±1021.75%     0 ns       1000 ns
2 gb_sets:intersection        1.30 M      768.44 ns  ¬±2657.04%  1000 ns       1000 ns

Comparison:
1 mapsets:intersection        2.53 M
3 ordsets:intersection        2.12 M - 1.19x slower +76.90 ns
2 gb_sets:intersection        1.30 M - 1.95x slower +373.75 ns

##### With input a2 Interspersed (10) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        1.96 M      510.95 ns  ¬±2509.15%     0 ns       1000 ns
3 ordsets:intersection        1.30 M      770.06 ns   ¬±676.65%  1000 ns       1000 ns
2 gb_sets:intersection        0.81 M     1240.22 ns  ¬±1388.14%  1000 ns       2000 ns

Comparison:
1 mapsets:intersection        1.96 M
3 ordsets:intersection        1.30 M - 1.51x slower +259.11 ns
2 gb_sets:intersection        0.81 M - 2.43x slower +729.27 ns

##### With input a3 Interspersed (30) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection      845.89 K        1.18 Œºs  ¬±2713.20%     1 Œºs          2 Œºs
3 ordsets:intersection      495.26 K        2.02 Œºs   ¬±164.49%     2 Œºs          3 Œºs
2 gb_sets:intersection      324.61 K        3.08 Œºs   ¬±718.13%     3 Œºs          5 Œºs

Comparison:
1 mapsets:intersection      845.89 K
3 ordsets:intersection      495.26 K - 1.71x slower +0.84 Œºs
2 gb_sets:intersection      324.61 K - 2.61x slower +1.90 Œºs

##### With input b1 Half-left (5) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        4.66 M      214.57 ns  ¬±1896.59%     0 ns       1000 ns
3 ordsets:intersection        3.62 M      276.50 ns  ¬±1465.48%     0 ns       1000 ns
2 gb_sets:intersection        1.73 M      577.07 ns  ¬±5041.95%     0 ns       1000 ns

Comparison:
1 mapsets:intersection        4.66 M
3 ordsets:intersection        3.62 M - 1.29x slower +61.94 ns
2 gb_sets:intersection        1.73 M - 2.69x slower +362.51 ns

##### With input b2 Half-left (10) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        2.92 M      342.24 ns  ¬±9961.99%     0 ns       1000 ns
3 ordsets:intersection        2.09 M      478.76 ns  ¬±5507.02%     0 ns       1000 ns
2 gb_sets:intersection        0.96 M     1043.40 ns  ¬±2396.75%  1000 ns       2000 ns

Comparison:
1 mapsets:intersection        2.92 M
3 ordsets:intersection        2.09 M - 1.40x slower +136.53 ns
2 gb_sets:intersection        0.96 M - 3.05x slower +701.17 ns

##### With input b3 Half-left (30) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        1.72 M      580.48 ns  ¬±4998.64%     0 ns       1000 ns
3 ordsets:intersection        1.01 M      989.96 ns  ¬±2850.03%  1000 ns       2000 ns
2 gb_sets:intersection        0.44 M     2292.44 ns   ¬±981.37%  2000 ns       4000 ns

Comparison:
1 mapsets:intersection        1.72 M
3 ordsets:intersection        1.01 M - 1.71x slower +409.48 ns
2 gb_sets:intersection        0.44 M - 3.95x slower +1711.96 ns

##### With input b4 Half-left (50) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection      902.32 K        1.11 Œºs  ¬±1892.28%     1 Œºs          2 Œºs
3 ordsets:intersection      710.61 K        1.41 Œºs  ¬±1793.08%     1 Œºs          2 Œºs
2 gb_sets:intersection      282.62 K        3.54 Œºs   ¬±495.73%     3 Œºs         11 Œºs

Comparison:
1 mapsets:intersection      902.32 K
3 ordsets:intersection      710.61 K - 1.27x slower +0.30 Œºs
2 gb_sets:intersection      282.62 K - 3.19x slower +2.43 Œºs

##### With input c1 Halt-right (5) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        4.70 M      212.66 ns  ¬±1573.58%     0 ns       1000 ns
3 ordsets:intersection        3.77 M      265.19 ns  ¬±1597.40%     0 ns       1000 ns
2 gb_sets:intersection        1.76 M      567.11 ns  ¬±4249.42%     0 ns       1000 ns

Comparison:
1 mapsets:intersection        4.70 M
3 ordsets:intersection        3.77 M - 1.25x slower +52.53 ns
2 gb_sets:intersection        1.76 M - 2.67x slower +354.45 ns

##### With input c2 Halt-right (10) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        3.14 M      318.35 ns  ¬±7626.82%     0 ns       1000 ns
3 ordsets:intersection        2.23 M      449.20 ns  ¬±5268.98%     0 ns       1000 ns
2 gb_sets:intersection        0.99 M     1014.32 ns  ¬±2177.84%  1000 ns       2000 ns

Comparison:
1 mapsets:intersection        3.14 M
3 ordsets:intersection        2.23 M - 1.41x slower +130.85 ns
2 gb_sets:intersection        0.99 M - 3.19x slower +695.97 ns

##### With input c3 Halt-right (30) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        1.78 M      560.38 ns  ¬±5118.91%     0 ns       1000 ns
3 ordsets:intersection        1.01 M      989.13 ns  ¬±2292.17%  1000 ns       2000 ns
2 gb_sets:intersection        0.44 M     2294.68 ns   ¬±981.21%  2000 ns       4000 ns

Comparison:
1 mapsets:intersection        1.78 M
3 ordsets:intersection        1.01 M - 1.77x slower +428.75 ns
2 gb_sets:intersection        0.44 M - 4.09x slower +1734.30 ns

##### With input c4 Half-right (50) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection      875.40 K        1.14 Œºs  ¬±1770.92%     1 Œºs          2 Œºs
3 ordsets:intersection      703.96 K        1.42 Œºs  ¬±1911.40%     1 Œºs          3 Œºs
2 gb_sets:intersection      294.25 K        3.40 Œºs   ¬±488.43%     3 Œºs          6 Œºs

Comparison:
1 mapsets:intersection      875.40 K
3 ordsets:intersection      703.96 K - 1.24x slower +0.28 Œºs
2 gb_sets:intersection      294.25 K - 2.98x slower +2.26 Œºs

##### With input d1 Equal (5) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        3.29 M      303.69 ns  ¬±9348.28%     0 ns       1000 ns
3 ordsets:intersection        2.19 M      455.98 ns  ¬±5799.97%     0 ns       1000 ns
2 gb_sets:intersection        1.15 M      869.11 ns  ¬±3884.46%  1000 ns       2000 ns

Comparison:
1 mapsets:intersection        3.29 M
3 ordsets:intersection        2.19 M - 1.50x slower +152.29 ns
2 gb_sets:intersection        1.15 M - 2.86x slower +565.41 ns

##### With input d2 Equal (10) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection        2.93 M      341.11 ns  ¬±3839.65%     0 ns       1000 ns
3 ordsets:intersection        1.85 M      540.08 ns  ¬±2436.90%     0 ns       1000 ns
2 gb_sets:intersection        0.72 M     1388.21 ns  ¬±1540.59%  1000 ns       2000 ns

Comparison:
1 mapsets:intersection        2.93 M
3 ordsets:intersection        1.85 M - 1.58x slower +198.97 ns
2 gb_sets:intersection        0.72 M - 4.07x slower +1047.11 ns

##### With input d3 Equal (30) #####
Name                             ips        average  deviation   median        99th %
1 mapsets:intersection     1395.63 K        0.72 Œºs  ¬±4359.84%     1 Œºs          1 Œºs
3 ordsets:intersection      744.64 K        1.34 Œºs  ¬±1845.56%     1 Œºs          2 Œºs
2 gb_sets:intersection      302.52 K        3.31 Œºs   ¬±672.80%     3 Œºs         10 Œºs

Comparison:
1 mapsets:intersection     1395.63 K
3 ordsets:intersection      744.64 K - 1.87x slower +0.63 Œºs
2 gb_sets:intersection      302.52 K - 4.61x slower +2.59 Œºs
</code></pre>
</div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="col-lg-12 text-center"><div class="col-lg-4"><a title="DOWNLOAD" href="/download.html"><img src="/img/download.png"/></a></div><div class="col-lg-4"><a href="http://www.github.com/erlang/otp/"><img src="/img/GitHub-Mark-32px.png"/></a></div><div class="col-lg-4"><a href="http://www.twitter.com/erlang_org/"><img src="/img/twitter.png" width="32"/></a></div></div><div class="col-lg-12"><div class="divider"><p></p></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"index":{"id":"0050","content":"\u003cpre\u003e\u003ccode\u003eAuthor: Jos√© Valim \u0026lt;jose(dot)valim(at)gmail(dot)com\u0026gt;\nStatus: Draft\nType: Standards Track\nCreated: 18-Sep-2019\nPost-History:\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003chr /\u003e\n\n\u003ch2\u003e\u003ca href=\"/eeps/eep-0000\" title=\"EEP Index\"\u003eEEP\u003c/a\u003e 50: \u003ca href=\"eep-0050.md\" title=\"EEP Source\"\u003e Maps based set implementation\u003c/a\u003e\u003c/h2\u003e\n\n\u003ch1\u003eAbstract\u003c/h1\u003e\n\n\u003cp\u003eThis EEP proposes a maps-based set implementation and a group of BIFs\nwith the goal of providing a \u003cem\u003ede facto\u003c/em\u003e sets implementation in Erlang/OTP.\u003c/p\u003e\n\n\u003ch1\u003eMotivation\u003c/h1\u003e\n\n\u003cp\u003eIn order to efficiently use sets in Erlang/OTP today, one has to\nconsider three different options:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eordsets\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egb_sets\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eusing maps as sets (such as \u003ccode\u003ecerl_sets\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFor example, if you wish to perform unions/intersections/subtractions,\n\u003ccode\u003eordsets\u003c/code\u003e is generally the most efficient. For individual lookups,\n\u003ccode\u003egb_sets\u003c/code\u003e and \"maps as sets\" are preferred, although the latter has no\nofficial API in Erlang/OTP. If you need a mixed profile, the best choice\nbecomes blurrier. Note there is also a \u003ccode\u003esets\u003c/code\u003e module, but it is rarely a\nviable option.\u003c/p\u003e\n\n\u003cp\u003eThe current landscape with sets is not much different than the dictionary\nlandscape before Erlang/OTP 17. Luckily, once \u003ccode\u003emaps\u003c/code\u003e were added, \u003ccode\u003emaps\u003c/code\u003e\nbecame the \u003cem\u003ede facto\u003c/em\u003e dictionary in Erlang. The other dictionary-like\nmodules may perform better under limited occasions but \u003ccode\u003emaps\u003c/code\u003e provide\nthe best profile in many scenarios and are a reasonable starting point\n(until a need for benchmarking and profiling arises - if it ever arises).\u003c/p\u003e\n\n\u003cp\u003eThe goal of this EEP is to propose a map-based sets solution with a group\nof BIFs that will give developers a sets implementation that can be\ngenerally treated as the main set implementation in Erlang/OTP.\u003c/p\u003e\n\n\u003ch1\u003eRationale\u003c/h1\u003e\n\n\u003cp\u003eDictionaries and sets implementation tend to walk side-by-side. Such as\n\u003ccode\u003eordsets\u003c/code\u003e and \u003ccode\u003eorddict\u003c/code\u003e, \u003ccode\u003egb_trees\u003c/code\u003e and \u003ccode\u003egb_sets\u003c/code\u003e. That's because you can\nconsider elements in a set to be keys in a dictionary, where you don't care\nabout the value for the keys.\u003c/p\u003e\n\n\u003cp\u003eGiven we have dictionaries implemented as maps, could we have sets based\non maps? The answer is yes and there are two approaches. The first approach\nis to provide a native data structure, implemented in C, with its own\nsyntax.  The advantage of said approach would be lower memory usage,\nbut it has a large impact on the language and on the runtime. Therefore\nthat's not the approach we will pursue here.\u003c/p\u003e\n\n\u003cp\u003eThe second approach, which this EEP advocates for, is to implement \u003ccode\u003esets\u003c/code\u003e\non top of maps, as done by \u003ccode\u003ecerl_sets\u003c/code\u003e. In this scenario, the sets elements\nare keys in the map and the values are empty lists (we chose empty lists\nbecause they are very cheap to serialize).\u003c/p\u003e\n\n\u003cp\u003eUsing \"maps as sets\" provide good performance characteristics today for\ninserting, adding and deleting set elements, being faster than all other\nimplementations. However, in terms of memory usage, \"maps as sets\" use\nalmost two times more memory than \u003ccode\u003eordsets\u003c/code\u003e (although note that the set\noperations themselves may end-up using less memory). Compared to \u003ccode\u003egb_sets\u003c/code\u003e,\n\"maps as sets\" use less memory altogether.\u003c/p\u003e\n\n\u003cp\u003eBut can \"maps as sets\" be as fast as \u003ccode\u003eordsets\u003c/code\u003e for unions, intersections and\nsubtractions?\u003c/p\u003e\n\n\u003cp\u003eThe good news is: \u003cstrong\u003ethis is already true for unions\u003c/strong\u003e, which is equivalent\nto \u003ccode\u003emaps:merge/2\u003c/code\u003e. Benchmarks are available in the addendum and we can take\nthe following conclusions:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003ewhen unioning integers elements, maps and ordsets take roughly the same\ntime, with maps slightly ahead except in cases where we have to go from\nsmall maps to large maps\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ewhen unioning tuples elements, maps are consistently faster, sometimes\n2 to 4 times, except in cases where we have to go from small maps to\nlarge maps. This is expected, the more expensive it becomes to compare\nitems, the more expensive \u003ccode\u003eordsets\u003c/code\u003e become\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis means that, if we could implement intersection and subtraction on top\nof maps, then it will likely be more efficient than ordsets, since\nintersection and subtraction do not have the issue of map resizing.\u003c/p\u003e\n\n\u003cp\u003eA proof of concept was written for intersections using small and mixed maps\nwith positive results (see benchmarks in addendum). We can also see the new\nintersections are consistently faster than \u003ccode\u003ecerl_sets\u003c/code\u003e. Unfortunately there\nare no benchmarks for intersections between two large maps due to lack of C\nexpertise of this EEP author. The assumption, which should be verified, is\nthat intersecting large maps will be faster than intersecting large\n\u003ccode\u003eordsets\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eGiven the results seen in \u003ccode\u003emaps:merge/2\u003c/code\u003e and the fact that map resizing does\nnot happen on intersections, this assumption will likely turn out to be\ntrue.\u003c/p\u003e\n\n\u003cp\u003eTherefore, if our goal is to make \u003ccode\u003emaps\u003c/code\u003e as fast as \u003ccode\u003eordsets\u003c/code\u003e for those\noperations, we need to implement new BIFs.\u003c/p\u003e\n\n\u003ch1\u003eSpecification\u003c/h1\u003e\n\n\u003cp\u003e\"maps as sets\" are generally more efficient than the existing set\nimplementations for checking, adding and deleting elements. However,\nthey are slower than \u003ccode\u003eordsets\u003c/code\u003e in the following operations:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003efrom_list/1\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eis_subset/2\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eis_disjoint/2\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eintersection/2\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esubtract/2\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eTherefore, if we want to have a \u003cem\u003ede facto\u003c/em\u003e set implementation, the functions\nabove would have to implemented as BIFs. The first three provide only\npartial speed-ups compared to a pure Erlang implementation but the last two\noperations with provide drastic gains as NIFs. The last two operations\nare also the most complex to implement.\u003c/p\u003e\n\n\u003cp\u003eWith the changes above, the only operations in \"maps as sets\" that won't be\nas fast or faster than \"ordsets\" is \u003ccode\u003eto_list\u003c/code\u003e and \u003ccode\u003efold\u003c/code\u003e, since \u003ccode\u003eordsets\u003c/code\u003e\nare lists internally.\u003c/p\u003e\n\n\u003cp\u003eAssuming the functionality above is validated as more performant (at least\nfor intersections and subtractions) and there is an interest in providing\nsaid functionality, the last question is: how should this functionality be\nexposed?\u003c/p\u003e\n\n\u003ch1\u003ePossible APIs for \"maps as sets\"\u003c/h1\u003e\n\n\u003ch3\u003e1. Augment the maps module\u003c/h3\u003e\n\n\u003cp\u003eIf there is no interest in adding new module to OTP, the \"maps\" module could\nbe augmented to have set-based operations. In those cases, only the keys are\ncompared. The values can come from either the first or the second map.\u003c/p\u003e\n\n\u003cp\u003eWhile this approach will improve performance, the \u003ccode\u003eintersection/2\u003c/code\u003e and\n\u003ccode\u003esubtract/2\u003c/code\u003e APIs in \u003ccode\u003emaps\u003c/code\u003e are quite awkward. One alternative is to prefix\nthose operations with the \u003ccode\u003ekey\u003c/code\u003e prefix, such as \u003ccode\u003ekeyintersection\u003c/code\u003e,\nto make it clear they are about the intersection of keys. But perhaps\na better approach altogether is to define a separate module.\u003c/p\u003e\n\n\u003ch3\u003e2. Add \u003ccode\u003emapsets\u003c/code\u003e module\u003c/h3\u003e\n\n\u003cp\u003eThe \u003ccode\u003emapsets\u003c/code\u003e module provide sets based on maps. The fact said sets are\nbased on maps is part of the public API (i.e. they are not an opaque type),\nexactly like \u003ccode\u003eordsets\u003c/code\u003e. The value for each key is the empty list to make\nsure sets can be cheapily serialized.\u003c/p\u003e\n\n\u003cp\u003eThis new module would have 5 BIFs:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emapsets:from_list/1\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emapsets:intersection/2\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emapsets:is_subset/2\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emapsets:is_disjoint/2\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emapsets:subtract/2\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe remaining APIs would be implemented on top of the maps API.\u003c/p\u003e\n\n\u003ch3\u003e3. Change the \u003ccode\u003esets\u003c/code\u003e module\u003c/h3\u003e\n\n\u003cp\u003eAnother option, similar to the above, is to leverage the fact the \u003ccode\u003esets\u003c/code\u003e\ntype is opaque and replace its implementation by \"maps as sets\". The\nadvantages of this approach is that everyone using \u003ccode\u003esets\u003c/code\u003e today would get\na performance upgrade and we would avoid adding a new module to Erlang/OTP.\nAfter all, there is always a risk that by adding a fourth option that\nunifies all three existing options, we will simply end-up with four options.\u003c/p\u003e\n\n\u003cp\u003eThe downside of this approach is that, although the \u003ccode\u003esets\u003c/code\u003e datastructure is\nopaque, developers may have serialized it elsewhere, and therefore the\nexisting data structure must still be supported. This means we would first\nneed to modify the \u003ccode\u003esets\u003c/code\u003e module to support both old sets and the new\n\"maps as sets\".  Support for the old data structure can be removed only\nin future versions. We would also need to discuss an appropriate\nmigration path.\u003c/p\u003e\n\n\u003ch1\u003eNext Steps\u003c/h1\u003e\n\n\u003cp\u003eAt the current stage, the proposal is a draft and not fully specified. In\nparticular, it is necessary to validate the implementation of some\noperations and benchmark them. It is also necessary to choose a relevant\nAPI for the propose functionality.\u003c/p\u003e\n\n\u003cp\u003eThat said, if this proposal is viewed positively, the proposed next steps\nare:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eValidate that intersections with maps is faster than with ordsets\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eChoose the desired API for \"maps as sets\" (i.e. choose between 1.\n extending \u003ccode\u003emaps\u003c/code\u003e, 2. adding \u003ccode\u003emapsets\u003c/code\u003e, or 3. changing \u003ccode\u003esets\u003c/code\u003e)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eImplement the chosen API in Erlang (most of the \u003ccode\u003ecerl_sets\u003c/code\u003e\n implementation can be leveraged)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOptimize the relevant operations as BIFs\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe author of the EEP can help by implementating step 3.\u003c/p\u003e\n\n\u003ch1\u003eCopyright\u003c/h1\u003e\n\n\u003cp\u003eThis document has been placed in the public domain.\u003c/p\u003e\n\n\u003cp\u003e[VimVar]: \u0026lt;\u003e \" vim: set fileencoding=utf-8 expandtab shiftwidth=4\nsofttabstop=4: \"\u003c/p\u003e\n\n\u003ch1\u003eAddendum: Union benchmark results\u003c/h1\u003e\n\n\u003ch3\u003eUnioning sets of integers\u003c/h3\u003e\n\n\u003cpre\u003e\u003ccode\u003eOperating System: macOS\nCPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz\nNumber of Available Cores: 8\nAvailable memory: 16 GB\nElixir 1.9.0\nErlang 23-master\n\nBenchmark suite executing with the following configuration:\nwarmup: 2 s\ntime: 5 s\nmemory time: 0 ns\nparallel: 1\nEstimated total run time: 8.40 min\n\n##### With input a1 Interspersed (5) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           4.18 M      239.50 ns ¬±13926.78%           0 ns\n   1000 ns\n3 ordsets:union        2.73 M      365.68 ns  ¬±8833.12%           0 ns\n   1000 ns\n2 gb_sets:union        0.99 M     1008.99 ns  ¬±2897.13%        1000 ns\n   2000 ns\n\nComparison:\n1 maps:merge           4.18 M\n3 ordsets:union        2.73 M - 1.53x slower +126.19 ns\n2 gb_sets:union        0.99 M - 4.21x slower +769.49 ns\n\n##### With input a2 Interspersed (10) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           3.60 M      277.93 ns  ¬±9122.84%           0 ns\n   1000 ns\n3 ordsets:union        1.93 M      517.34 ns  ¬±5920.40%           0 ns\n   1000 ns\n2 gb_sets:union        0.62 M     1624.47 ns  ¬±2115.84%        1000 ns\n   3000 ns\n\nComparison:\n1 maps:merge           3.60 M\n3 ordsets:union        1.93 M - 1.86x slower +239.41 ns\n2 gb_sets:union        0.62 M - 5.84x slower +1346.54 ns\n\n##### With input a3 Interspersed (30) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union     1012.27 K        0.99 Œºs  ¬±4048.88%           1 Œºs\n      2 Œºs\n1 maps:merge         318.99 K        3.13 Œºs   ¬±558.61%           3 Œºs\n      7 Œºs\n2 gb_sets:union      270.93 K        3.69 Œºs   ¬±222.80%           3 Œºs\n     12 Œºs\n\nComparison:\n3 ordsets:union     1012.27 K\n1 maps:merge         318.99 K - 3.17x slower +2.15 Œºs\n2 gb_sets:union      270.93 K - 3.74x slower +2.70 Œºs\n\n##### With input a4 Interspersed (50) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge        1149.76 K        0.87 Œºs  ¬±3450.02%           1 Œºs\n      2 Œºs\n3 ordsets:union      584.09 K        1.71 Œºs  ¬±1716.00%           1 Œºs\n      4 Œºs\n2 gb_sets:union      146.62 K        6.82 Œºs   ¬±311.32%           6 Œºs\n     25 Œºs\n\nComparison:\n1 maps:merge        1149.76 K\n3 ordsets:union      584.09 K - 1.97x slower +0.84 Œºs\n2 gb_sets:union      146.62 K - 7.84x slower +5.95 Œºs\n\n##### With input a5 Interspersed (1000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge          71.57 K       13.97 Œºs   ¬±154.74%          12 Œºs\n     44 Œºs\n3 ordsets:union       33.29 K       30.04 Œºs   ¬±134.28%          25 Œºs\n     92 Œºs\n2 gb_sets:union        8.36 K      119.56 Œºs    ¬±52.83%         106 Œºs\n    255 Œºs\n\nComparison:\n1 maps:merge          71.57 K\n3 ordsets:union       33.29 K - 2.15x slower +16.07 Œºs\n2 gb_sets:union        8.36 K - 8.56x slower +105.58 Œºs\n\n##### With input a6 Interspersed (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           275.98        3.62 ms    ¬±36.94%        2.75 ms\n   7.26 ms\n3 ordsets:union        247.19        4.05 ms    ¬±14.63%        4.01 ms\n   5.39 ms\n2 gb_sets:union         43.70       22.88 ms    ¬±28.56%       20.66 ms\n  44.84 ms\n\nComparison:\n1 maps:merge           275.98\n3 ordsets:union        247.19 - 1.12x slower +0.42 ms\n2 gb_sets:union         43.70 - 6.32x slower +19.26 ms\n\n##### With input b1 Half-left (5) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union        5.14 M      194.71 ns  ¬±2814.44%           0 ns\n   1000 ns\n1 maps:merge           4.80 M      208.36 ns ¬±20621.17%           0 ns\n   1000 ns\n2 gb_sets:union        1.48 M      673.48 ns  ¬±4924.77%        1000 ns\n   1000 ns\n\nComparison:\n3 ordsets:union        5.14 M\n1 maps:merge           4.80 M - 1.07x slower +13.65 ns\n2 gb_sets:union        1.48 M - 3.46x slower +478.77 ns\n\n##### With input b2 Half-left (10) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           4.42 M      226.29 ns  ¬±9473.44%           0 ns\n   1000 ns\n3 ordsets:union        3.73 M      268.01 ns ¬±12800.39%           0 ns\n   1000 ns\n2 gb_sets:union        0.87 M     1144.30 ns  ¬±2389.89%        1000 ns\n   2000 ns\n\nComparison:\n1 maps:merge           4.42 M\n3 ordsets:union        3.73 M - 1.18x slower +41.72 ns\n2 gb_sets:union        0.87 M - 5.06x slower +918.01 ns\n\n##### With input b3 Half-left (30) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           2.64 M      378.92 ns ¬±12298.14%           0 ns\n   1000 ns\n3 ordsets:union        1.70 M      589.31 ns  ¬±7472.62%           0 ns\n   1000 ns\n2 gb_sets:union        0.43 M     2326.42 ns   ¬±393.28%        2000 ns\n   4000 ns\n\nComparison:\n1 maps:merge           2.64 M\n3 ordsets:union        1.70 M - 1.56x slower +210.39 ns\n2 gb_sets:union        0.43 M - 6.14x slower +1947.49 ns\n\n##### With input b4 Half-left (50) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union     1365.15 K        0.73 Œºs  ¬±3249.86%           1 Œºs\n      1 Œºs\n1 maps:merge         587.14 K        1.70 Œºs  ¬±1709.70%           1 Œºs\n      3 Œºs\n2 gb_sets:union      254.37 K        3.93 Œºs   ¬±510.57%           3 Œºs\n     16 Œºs\n\nComparison:\n3 ordsets:union     1365.15 K\n1 maps:merge         587.14 K - 2.33x slower +0.97 Œºs\n2 gb_sets:union      254.37 K - 5.37x slower +3.20 Œºs\n\n##### With input b5 Half-left (1000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge         130.95 K        7.64 Œºs    ¬±44.63%           7 Œºs\n     25 Œºs\n3 ordsets:union      112.42 K        8.90 Œºs   ¬±271.51%           8 Œºs\n     34 Œºs\n2 gb_sets:union       14.89 K       67.17 Œºs    ¬±81.58%          58 Œºs\n 167.75 Œºs\n\nComparison:\n1 maps:merge         130.95 K\n3 ordsets:union      112.42 K - 1.16x slower +1.26 Œºs\n2 gb_sets:union       14.89 K - 8.80x slower +59.54 Œºs\n\n##### With input b6 Half-left (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           736.54        1.36 ms    ¬±13.50%        1.30 ms\n   2.17 ms\n3 ordsets:union        424.33        2.36 ms    ¬±20.47%        2.28 ms\n   3.81 ms\n2 gb_sets:union        111.06        9.00 ms    ¬±14.00%        8.64 ms\n  14.87 ms\n\nComparison:\n1 maps:merge           736.54\n3 ordsets:union        424.33 - 1.74x slower +1.00 ms\n2 gb_sets:union        111.06 - 6.63x slower +7.65 ms\n\n##### With input c1 Half-right (5) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union        5.39 M      185.61 ns  ¬±3347.98%           0 ns\n   1000 ns\n1 maps:merge           4.44 M      224.99 ns ¬±18210.87%           0 ns\n   1000 ns\n2 gb_sets:union        1.38 M      726.62 ns  ¬±5484.65%        1000 ns\n   2000 ns\n\nComparison:\n3 ordsets:union        5.39 M\n1 maps:merge           4.44 M - 1.21x slower +39.37 ns\n2 gb_sets:union        1.38 M - 3.91x slower +541.01 ns\n\n##### With input c2 Half-right (10) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           4.50 M      222.20 ns  ¬±6200.17%           0 ns\n   1000 ns\n3 ordsets:union        3.66 M      273.47 ns ¬±11368.54%           0 ns\n   1000 ns\n2 gb_sets:union        0.91 M     1097.73 ns  ¬±2497.65%        1000 ns\n   2000 ns\n\nComparison:\n1 maps:merge           4.50 M\n3 ordsets:union        3.66 M - 1.23x slower +51.26 ns\n2 gb_sets:union        0.91 M - 4.94x slower +875.52 ns\n\n##### With input c3 Half-right (30) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           2.88 M      346.75 ns ¬±11287.26%           0 ns\n   1000 ns\n3 ordsets:union        1.87 M      534.45 ns  ¬±5864.66%           0 ns\n   1000 ns\n2 gb_sets:union        0.42 M     2353.46 ns   ¬±409.72%        2000 ns\n   5000 ns\n\nComparison:\n1 maps:merge           2.88 M\n3 ordsets:union        1.87 M - 1.54x slower +187.69 ns\n2 gb_sets:union        0.42 M - 6.79x slower +2006.70 ns\n\n##### With input c4 Half-right (50) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union     1405.29 K        0.71 Œºs  ¬±4860.25%           1 Œºs\n      2 Œºs\n1 maps:merge         541.91 K        1.85 Œºs  ¬±1461.20%           2 Œºs\n      3 Œºs\n2 gb_sets:union      248.12 K        4.03 Œºs   ¬±526.17%           3 Œºs\n     17 Œºs\n\nComparison:\n3 ordsets:union     1405.29 K\n1 maps:merge         541.91 K - 2.59x slower +1.13 Œºs\n2 gb_sets:union      248.12 K - 5.66x slower +3.32 Œºs\n\n##### With input c5 Half-right (1000) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union      117.05 K        8.54 Œºs   ¬±180.01%           8 Œºs\n     32 Œºs\n1 maps:merge         106.28 K        9.41 Œºs   ¬±706.19%           8 Œºs\n     28 Œºs\n2 gb_sets:union       14.62 K       68.38 Œºs    ¬±69.45%          59 Œºs\n    149 Œºs\n\nComparison:\n3 ordsets:union      117.05 K\n1 maps:merge         106.28 K - 1.10x slower +0.87 Œºs\n2 gb_sets:union       14.62 K - 8.00x slower +59.84 Œºs\n\n##### With input c6 Half-right (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           447.90        2.23 ms    ¬±42.50%        1.81 ms\n   6.07 ms\n3 ordsets:union        312.45        3.20 ms    ¬±35.75%        2.92 ms\n   7.20 ms\n2 gb_sets:union        110.13        9.08 ms    ¬±14.75%        8.72 ms\n  16.01 ms\n\nComparison:\n1 maps:merge           447.90\n3 ordsets:union        312.45 - 1.43x slower +0.97 ms\n2 gb_sets:union        110.13 - 4.07x slower +6.85 ms\n\n##### With input d1 Equal (5) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           4.03 M      248.00 ns ¬±13008.64%           0 ns\n   1000 ns\n3 ordsets:union        3.41 M      293.08 ns ¬±11881.46%           0 ns\n   1000 ns\n2 gb_sets:union        1.34 M      748.45 ns  ¬±5426.61%        1000 ns\n   2000 ns\n\nComparison:\n1 maps:merge           4.03 M\n3 ordsets:union        3.41 M - 1.18x slower +45.08 ns\n2 gb_sets:union        1.34 M - 3.02x slower +500.44 ns\n\n##### With input d2 Equal (10) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union        3.33 M      300.31 ns  ¬±5298.85%           0 ns\n   1000 ns\n1 maps:merge           2.81 M      355.61 ns ¬±14326.68%           0 ns\n   1000 ns\n2 gb_sets:union        0.75 M     1337.84 ns  ¬±2488.47%        1000 ns\n   4000 ns\n\nComparison:\n3 ordsets:union        3.33 M\n1 maps:merge           2.81 M - 1.18x slower +55.30 ns\n2 gb_sets:union        0.75 M - 4.45x slower +1037.53 ns\n\n##### With input d3 Equal (30) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           2.25 M      443.46 ns  ¬±8688.55%           0 ns\n   1000 ns\n3 ordsets:union        1.46 M      683.82 ns  ¬±3817.58%        1000 ns\n   1000 ns\n2 gb_sets:union        0.37 M     2686.18 ns   ¬±483.99%        2000 ns\n   9000 ns\n\nComparison:\n1 maps:merge           2.25 M\n3 ordsets:union        1.46 M - 1.54x slower +240.36 ns\n2 gb_sets:union        0.37 M - 6.06x slower +2242.72 ns\n\n##### With input d4 Equal (50) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           1.50 M      668.83 ns   ¬±132.24%        1000 ns\n   1000 ns\n3 ordsets:union        1.04 M      960.02 ns  ¬±4458.67%        1000 ns\n   2000 ns\n2 gb_sets:union        0.22 M     4523.49 ns   ¬±196.98%        4000 ns\n  18000 ns\n\nComparison:\n1 maps:merge           1.50 M\n3 ordsets:union        1.04 M - 1.44x slower +291.19 ns\n2 gb_sets:union        0.22 M - 6.76x slower +3854.66 ns\n\n##### With input d5 Equal (1000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge          81.92 K       12.21 Œºs    ¬±57.31%          11 Œºs\n     32 Œºs\n3 ordsets:union       77.39 K       12.92 Œºs   ¬±129.75%          12 Œºs\n     39 Œºs\n2 gb_sets:union       12.72 K       78.63 Œºs    ¬±43.08%          70 Œºs\n    174 Œºs\n\nComparison:\n1 maps:merge          81.92 K\n3 ordsets:union       77.39 K - 1.06x slower +0.71 Œºs\n2 gb_sets:union       12.72 K - 6.44x slower +66.43 Œºs\n\n##### With input d6 Equal (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           646.20        1.55 ms    ¬±18.21%        1.45 ms\n   2.86 ms\n3 ordsets:union        305.88        3.27 ms    ¬±16.73%        3.22 ms\n   4.79 ms\n2 gb_sets:union         96.06       10.41 ms    ¬±18.09%        9.72 ms\n  17.41 ms\n\nComparison:\n1 maps:merge           646.20\n3 ordsets:union        305.88 - 2.11x slower +1.72 ms\n2 gb_sets:union         96.06 - 6.73x slower +8.86 ms\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003ch3\u003eUnioning sets of tuple-integers\u003c/h3\u003e\n\n\u003cpre\u003e\u003ccode\u003eOperating System: macOS\nCPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz\nNumber of Available Cores: 8\nAvailable memory: 16 GB\nElixir 1.9.0\nErlang 23-master\n\nBenchmark suite executing with the following configuration:\nwarmup: 2 s\ntime: 5 s\nmemory time: 0 ns\nparallel: 1\nEstimated total run time: 8.40 min\n\n##### With input a1 Interspersed (5) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           2.93 M      341.36 ns  ¬±2603.07%           0 ns\n   1000 ns\n3 ordsets:union        1.62 M      616.04 ns  ¬±4989.81%           0 ns\n   1000 ns\n2 gb_sets:union        0.82 M     1219.38 ns  ¬±2533.38%        1000 ns\n   2000 ns\n\nComparison:\n1 maps:merge           2.93 M\n3 ordsets:union        1.62 M - 1.80x slower +274.68 ns\n2 gb_sets:union        0.82 M - 3.57x slower +878.02 ns\n\n##### With input a2 Interspersed (10) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           2.02 M      494.89 ns  ¬±2798.11%           0 ns\n   1000 ns\n3 ordsets:union        1.04 M      963.72 ns  ¬±2195.45%        1000 ns\n   2000 ns\n2 gb_sets:union        0.50 M     2012.64 ns  ¬±1226.89%        2000 ns\n   4000 ns\n\nComparison:\n1 maps:merge           2.02 M\n3 ordsets:union        1.04 M - 1.95x slower +468.83 ns\n2 gb_sets:union        0.50 M - 4.07x slower +1517.75 ns\n\n##### With input a3 Interspersed (30) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union      408.22 K        2.45 Œºs   ¬±828.38%           2 Œºs\n      4 Œºs\n1 maps:merge         234.27 K        4.27 Œºs   ¬±330.95%           4 Œºs\n     10 Œºs\n2 gb_sets:union      189.97 K        5.26 Œºs   ¬±643.32%           5 Œºs\n     18 Œºs\n\nComparison:\n3 ordsets:union      408.22 K\n1 maps:merge         234.27 K - 1.74x slower +1.82 Œºs\n2 gb_sets:union      189.97 K - 2.15x slower +2.81 Œºs\n\n##### With input a4 Interspersed (50) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge         767.56 K        1.30 Œºs  ¬±1279.19%           1 Œºs\n      2 Œºs\n3 ordsets:union      246.12 K        4.06 Œºs   ¬±267.03%           4 Œºs\n     14 Œºs\n2 gb_sets:union      108.33 K        9.23 Œºs   ¬±255.73%           8 Œºs\n     27 Œºs\n\nComparison:\n1 maps:merge         767.56 K\n3 ordsets:union      246.12 K - 3.12x slower +2.76 Œºs\n2 gb_sets:union      108.33 K - 7.09x slower +7.93 Œºs\n\n##### With input a5 Interspersed (1000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge          47.61 K       21.00 Œºs   ¬±196.69%          19 Œºs\n     59 Œºs\n3 ordsets:union       12.38 K       80.76 Œºs    ¬±53.12%          73 Œºs\n    193 Œºs\n2 gb_sets:union        6.04 K      165.68 Œºs    ¬±30.74%         152 Œºs\n    309 Œºs\n\nComparison:\n1 maps:merge          47.61 K\n3 ordsets:union       12.38 K - 3.84x slower +59.75 Œºs\n2 gb_sets:union        6.04 K - 7.89x slower +144.67 Œºs\n\n##### With input a6 Interspersed (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           210.63        4.75 ms    ¬±35.35%        3.77 ms\n   9.58 ms\n3 ordsets:union         74.84       13.36 ms    ¬±17.83%       12.73 ms\n  18.51 ms\n2 gb_sets:union         54.06       18.50 ms    ¬±14.28%       17.83 ms\n  24.21 ms\n\nComparison:\n1 maps:merge           210.63\n3 ordsets:union         74.84 - 2.81x slower +8.61 ms\n2 gb_sets:union         54.06 - 3.90x slower +13.75 ms\n\n##### With input b1 Half-left (5) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           4.49 M      222.57 ns  ¬±1774.31%           0 ns\n   1000 ns\n3 ordsets:union        3.33 M      300.45 ns  ¬±6349.54%           0 ns\n   1000 ns\n2 gb_sets:union        1.46 M      683.85 ns  ¬±2344.50%        1000 ns\n   1000 ns\n\nComparison:\n1 maps:merge           4.49 M\n3 ordsets:union        3.33 M - 1.35x slower +77.88 ns\n2 gb_sets:union        1.46 M - 3.07x slower +461.29 ns\n\n##### With input b2 Half-left (10) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           2.48 M      402.60 ns  ¬±9495.69%           0 ns\n   1000 ns\n3 ordsets:union        2.30 M      435.32 ns  ¬±1123.50%           0 ns\n   1000 ns\n2 gb_sets:union        0.76 M     1318.82 ns   ¬±818.75%        1000 ns\n   2000 ns\n\nComparison:\n1 maps:merge           2.48 M\n3 ordsets:union        2.30 M - 1.08x slower +32.73 ns\n2 gb_sets:union        0.76 M - 3.28x slower +916.23 ns\n\n##### With input b3 Half-left (30) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           1.54 M      648.33 ns  ¬±2884.79%           0 ns\n   1000 ns\n3 ordsets:union        1.09 M      921.12 ns   ¬±734.80%        1000 ns\n   2000 ns\n2 gb_sets:union        0.37 M     2728.75 ns   ¬±554.08%        2000 ns\n   6000 ns\n\nComparison:\n1 maps:merge           1.54 M\n3 ordsets:union        1.09 M - 1.42x slower +272.79 ns\n2 gb_sets:union        0.37 M - 4.21x slower +2080.42 ns\n\n##### With input b4 Half-left (50) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union      734.80 K        1.36 Œºs   ¬±978.11%           1 Œºs\n      3 Œºs\n1 maps:merge         439.62 K        2.27 Œºs  ¬±1429.61%           2 Œºs\n      5 Œºs\n2 gb_sets:union      224.47 K        4.45 Œºs   ¬±213.29%           4 Œºs\n     15 Œºs\n\nComparison:\n3 ordsets:union      734.80 K\n1 maps:merge         439.62 K - 1.67x slower +0.91 Œºs\n2 gb_sets:union      224.47 K - 3.27x slower +3.09 Œºs\n\n##### With input b5 Half-left (1000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge          76.01 K       13.16 Œºs   ¬±104.36%          12 Œºs\n     35 Œºs\n3 ordsets:union       45.29 K       22.08 Œºs   ¬±125.57%          20 Œºs\n     60 Œºs\n2 gb_sets:union       13.42 K       74.53 Œºs    ¬±44.00%          68 Œºs\n    164 Œºs\n\nComparison:\n1 maps:merge          76.01 K\n3 ordsets:union       45.29 K - 1.68x slower +8.93 Œºs\n2 gb_sets:union       13.42 K - 5.66x slower +61.37 Œºs\n\n##### With input b6 Half-left (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           530.32        1.89 ms    ¬±18.53%        1.77 ms\n   3.40 ms\n3 ordsets:union        139.97        7.14 ms    ¬±17.91%        7.01 ms\n  11.23 ms\n2 gb_sets:union         91.51       10.93 ms    ¬±12.31%       10.34 ms\n  15.62 ms\n\nComparison:\n1 maps:merge           530.32\n3 ordsets:union        139.97 - 3.79x slower +5.26 ms\n2 gb_sets:union         91.51 - 5.80x slower +9.04 ms\n\n##### With input c1 Half-right (5) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           4.46 M      224.32 ns  ¬±1730.97%           0 ns\n   1000 ns\n3 ordsets:union        3.78 M      264.68 ns  ¬±3293.90%           0 ns\n   1000 ns\n2 gb_sets:union        1.52 M      658.44 ns  ¬±1819.22%        1000 ns\n   1000 ns\n\nComparison:\n1 maps:merge           4.46 M\n3 ordsets:union        3.78 M - 1.18x slower +40.37 ns\n2 gb_sets:union        1.52 M - 2.94x slower +434.13 ns\n\n##### With input c2 Half-right (10) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union        2.36 M      424.51 ns  ¬±2870.39%           0 ns\n   1000 ns\n1 maps:merge           2.27 M      441.04 ns ¬±11548.99%           0 ns\n   1000 ns\n2 gb_sets:union        0.80 M     1248.21 ns   ¬±948.08%        1000 ns\n   2000 ns\n\nComparison:\n3 ordsets:union        2.36 M\n1 maps:merge           2.27 M - 1.04x slower +16.53 ns\n2 gb_sets:union        0.80 M - 2.94x slower +823.70 ns\n\n##### With input c3 Half-right (30) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           1.53 M      654.58 ns  ¬±2879.82%        1000 ns\n   1000 ns\n3 ordsets:union        1.13 M      885.52 ns  ¬±2213.29%        1000 ns\n   2000 ns\n2 gb_sets:union        0.37 M     2675.20 ns   ¬±502.40%        2000 ns\n   5000 ns\n\nComparison:\n1 maps:merge           1.53 M\n3 ordsets:union        1.13 M - 1.35x slower +230.94 ns\n2 gb_sets:union        0.37 M - 4.09x slower +2020.62 ns\n\n##### With input c4 Half-right (50) #####\nName                      ips        average  deviation         median\n    99th %\n3 ordsets:union      747.48 K        1.34 Œºs  ¬±1222.85%           1 Œºs\n      3 Œºs\n1 maps:merge         433.42 K        2.31 Œºs  ¬±1493.25%           2 Œºs\n      4 Œºs\n2 gb_sets:union      223.83 K        4.47 Œºs   ¬±283.66%           4 Œºs\n     13 Œºs\n\nComparison:\n3 ordsets:union      747.48 K\n1 maps:merge         433.42 K - 1.72x slower +0.97 Œºs\n2 gb_sets:union      223.83 K - 3.34x slower +3.13 Œºs\n\n##### With input c5 Half-right (1000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge          66.00 K       15.15 Œºs   ¬±321.69%          14 Œºs\n     41 Œºs\n3 ordsets:union       44.62 K       22.41 Œºs   ¬±767.12%          20 Œºs\n     60 Œºs\n2 gb_sets:union       13.20 K       75.74 Œºs    ¬±41.33%          70 Œºs\n    161 Œºs\n\nComparison:\n1 maps:merge          66.00 K\n3 ordsets:union       44.62 K - 1.48x slower +7.26 Œºs\n2 gb_sets:union       13.20 K - 5.00x slower +60.59 Œºs\n\n##### With input c6 Half-right (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           428.32        2.33 ms    ¬±28.88%        2.06 ms\n   4.05 ms\n3 ordsets:union        146.62        6.82 ms    ¬±18.71%        6.60 ms\n  10.79 ms\n2 gb_sets:union         91.45       10.93 ms    ¬±13.58%       10.27 ms\n  15.80 ms\n\nComparison:\n1 maps:merge           428.32\n3 ordsets:union        146.62 - 2.92x slower +4.49 ms\n2 gb_sets:union         91.45 - 4.68x slower +8.60 ms\n\n##### With input d1 Equal (5) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           3.61 M      276.63 ns  ¬±3338.58%           0 ns\n   1000 ns\n3 ordsets:union        2.42 M      414.07 ns  ¬±3326.82%           0 ns\n   1000 ns\n2 gb_sets:union        1.26 M      792.13 ns  ¬±1546.56%        1000 ns\n   2000 ns\n\nComparison:\n1 maps:merge           3.61 M\n3 ordsets:union        2.42 M - 1.50x slower +137.45 ns\n2 gb_sets:union        1.26 M - 2.86x slower +515.50 ns\n\n##### With input d2 Equal (10) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           2.15 M      464.77 ns  ¬±8475.08%           0 ns\n   1000 ns\n3 ordsets:union        1.88 M      531.65 ns   ¬±493.39%        1000 ns\n   1000 ns\n2 gb_sets:union        0.69 M     1459.20 ns  ¬±1113.96%        1000 ns\n   3000 ns\n\nComparison:\n1 maps:merge           2.15 M\n3 ordsets:union        1.88 M - 1.14x slower +66.89 ns\n2 gb_sets:union        0.69 M - 3.14x slower +994.43 ns\n\n##### With input d3 Equal (30) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge        1364.57 K        0.73 Œºs  ¬±4056.53%           1 Œºs\n      1 Œºs\n3 ordsets:union      742.74 K        1.35 Œºs  ¬±1193.06%           1 Œºs\n      2 Œºs\n2 gb_sets:union      307.17 K        3.26 Œºs   ¬±527.79%           3 Œºs\n      8 Œºs\n\nComparison:\n1 maps:merge        1364.57 K\n3 ordsets:union      742.74 K - 1.84x slower +0.61 Œºs\n2 gb_sets:union      307.17 K - 4.44x slower +2.52 Œºs\n\n##### With input d4 Equal (50) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge         816.34 K        1.22 Œºs   ¬±168.59%           1 Œºs\n      2 Œºs\n3 ordsets:union      451.06 K        2.22 Œºs  ¬±1119.27%           2 Œºs\n      4 Œºs\n2 gb_sets:union      184.50 K        5.42 Œºs   ¬±200.77%           5 Œºs\n     19 Œºs\n\nComparison:\n1 maps:merge         816.34 K\n3 ordsets:union      451.06 K - 1.81x slower +0.99 Œºs\n2 gb_sets:union      184.50 K - 4.42x slower +4.19 Œºs\n\n##### With input d5 Equal (1000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge          46.22 K       21.63 Œºs    ¬±39.65%          20 Œºs\n     53 Œºs\n3 ordsets:union       26.20 K       38.17 Œºs    ¬±63.50%          35 Œºs\n    101 Œºs\n2 gb_sets:union       10.24 K       97.66 Œºs    ¬±36.11%          90 Œºs\n    199 Œºs\n\nComparison:\n1 maps:merge          46.22 K\n3 ordsets:union       26.20 K - 1.76x slower +16.53 Œºs\n2 gb_sets:union       10.24 K - 4.51x slower +76.03 Œºs\n\n##### With input d6 Equal (100000) #####\nName                      ips        average  deviation         median\n    99th %\n1 maps:merge           440.81        2.27 ms    ¬±12.79%        2.17 ms\n   3.48 ms\n3 ordsets:union        126.12        7.93 ms    ¬±26.40%        7.11 ms\n  13.85 ms\n2 gb_sets:union         73.86       13.54 ms    ¬±18.78%       12.89 ms\n  19.27 ms\n\nComparison:\n1 maps:merge           440.81\n3 ordsets:union        126.12 - 3.50x slower +5.66 ms\n2 gb_sets:union         73.86 - 5.97x slower +11.27 ms\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003ch1\u003eAddendum: Intersection benchmark results\u003c/h1\u003e\n\n\u003ch3\u003eIntersection of sets of integers\u003c/h3\u003e\n\n\u003cpre\u003e\u003ccode\u003eOperating System: macOS\nCPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz\nNumber of Available Cores: 8\nAvailable memory: 16 GB\nElixir 1.9.0\nErlang 23-master\n\nBenchmark suite executing with the following configuration:\nwarmup: 2 s\ntime: 5 s\nmemory time: 0 ns\nparallel: 1\nEstimated total run time: 6.53 min\n\n##### With input a1 Interspersed (5) #####\nName                               ips        average  deviation   median       99th %\n1 mapsets:intersection          5.64 M      177.31 ns  ¬±8960.73%     0 ns      1000 ns\n3 ordsets:intersection          4.58 M      218.18 ns  ¬±1955.05%     0 ns      1000 ns\n2 gb_sets:intersection          1.85 M      541.24 ns  ¬±3690.38%     0 ns      1000 ns\n0 cerl_sets:intersection        1.81 M      551.00 ns  ¬±6378.03%     0 ns      1000 ns\n\nComparison:\n1 mapsets:intersection          5.64 M\n3 ordsets:intersection          4.58 M - 1.23x slower +40.87 ns\n2 gb_sets:intersection          1.85 M - 3.05x slower +363.93 ns\n0 cerl_sets:intersection        1.81 M - 3.11x slower +373.69 ns\n\n##### With input a2 Interspersed (10) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          3.87 M      258.37 ns  ¬±8156.88%     0 ns     1000 ns\n3 ordsets:intersection          3.25 M      307.69 ns   ¬±995.12%     0 ns     1000 ns\n0 cerl_sets:intersection        1.35 M      742.45 ns  ¬±4916.42%  1000 ns     1000 ns\n2 gb_sets:intersection          1.20 M      833.71 ns  ¬±3535.59%  1000 ns     1000 ns\n\nComparison:\n1 mapsets:intersection          3.87 M\n3 ordsets:intersection          3.25 M - 1.19x slower +49.32 ns\n0 cerl_sets:intersection        1.35 M - 2.87x slower +484.09 ns\n2 gb_sets:intersection          1.20 M - 3.23x slower +575.34 ns\n\n##### With input a3 Interspersed (30) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          2.37 M        0.42 Œºs  ¬±7530.28%     0 Œºs        1 Œºs\n3 ordsets:intersection          1.57 M        0.64 Œºs   ¬±571.54%     1 Œºs        1 Œºs\n0 cerl_sets:intersection        0.63 M        1.60 Œºs  ¬±1704.57%     1 Œºs        3 Œºs\n2 gb_sets:intersection          0.57 M        1.74 Œºs  ¬±1508.42%     2 Œºs        3 Œºs\n\nComparison:\n1 mapsets:intersection          2.37 M\n3 ordsets:intersection          1.57 M - 1.51x slower +0.21 Œºs\n0 cerl_sets:intersection        0.63 M - 3.79x slower +1.17 Œºs\n2 gb_sets:intersection          0.57 M - 4.13x slower +1.32 Œºs\n\n##### With input b1 Half-left (5) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          7.81 M      128.06 ns  ¬±3031.39%     0 ns     1000 ns\n3 ordsets:intersection          6.10 M      163.95 ns   ¬±819.87%     0 ns     1000 ns\n2 gb_sets:intersection          1.91 M      524.17 ns  ¬±3574.70%     0 ns     1000 ns\n0 cerl_sets:intersection        1.73 M      578.18 ns  ¬±5060.91%     0 ns     1000 ns\n\nComparison:\n1 mapsets:intersection          7.81 M\n3 ordsets:intersection          6.10 M - 1.28x slower +35.89 ns\n2 gb_sets:intersection          1.91 M - 4.09x slower +396.11 ns\n0 cerl_sets:intersection        1.73 M - 4.51x slower +450.12 ns\n\n##### With input b2 Half-left (10) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          5.34 M      187.35 ns  ¬±6435.27%     0 ns     1000 ns\n3 ordsets:intersection          3.50 M      285.53 ns  ¬±8907.47%     0 ns     1000 ns\n0 cerl_sets:intersection        1.25 M      801.68 ns  ¬±2618.59%  1000 ns     1000 ns\n2 gb_sets:intersection          1.15 M      865.97 ns  ¬±3771.19%  1000 ns     1000 ns\n\nComparison:\n1 mapsets:intersection          5.34 M\n3 ordsets:intersection          3.50 M - 1.52x slower +98.18 ns\n0 cerl_sets:intersection        1.25 M - 4.28x slower +614.33 ns\n2 gb_sets:intersection          1.15 M - 4.62x slower +678.63 ns\n\n##### With input b3 Half-left (30) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          3.12 M        0.32 Œºs ¬±10505.28%     0 Œºs        1 Œºs\n3 ordsets:intersection          1.79 M        0.56 Œºs  ¬±5943.47%     0 Œºs        1 Œºs\n0 cerl_sets:intersection        0.60 M        1.66 Œºs  ¬±1650.01%     1 Œºs        3 Œºs\n2 gb_sets:intersection          0.57 M        1.77 Œºs  ¬±1510.44%     2 Œºs        3 Œºs\n\nComparison:\n1 mapsets:intersection          3.12 M\n3 ordsets:intersection          1.79 M - 1.74x slower +0.24 Œºs\n0 cerl_sets:intersection        0.60 M - 5.17x slower +1.34 Œºs\n2 gb_sets:intersection          0.57 M - 5.51x slower +1.45 Œºs\n\n##### With input b4 Half-left (50) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          1.41 M        0.71 Œºs  ¬±4451.88%     1 Œºs        1 Œºs\n3 ordsets:intersection          1.32 M        0.76 Œºs  ¬±4422.37%     1 Œºs        1 Œºs\n2 gb_sets:intersection          0.37 M        2.72 Œºs   ¬±719.29%     2 Œºs        5 Œºs\n0 cerl_sets:intersection        0.31 M        3.26 Œºs   ¬±464.70%     3 Œºs        5 Œºs\n\nComparison:\n1 mapsets:intersection          1.41 M\n3 ordsets:intersection          1.32 M - 1.07x slower +0.0487 Œºs\n2 gb_sets:intersection          0.37 M - 3.82x slower +2.01 Œºs\n0 cerl_sets:intersection        0.31 M - 4.59x slower +2.55 Œºs\n\n##### With input c1 Halt-right (5) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          8.50 M      117.64 ns  ¬±3751.50%     0 ns     1000 ns\n3 ordsets:intersection          4.96 M      201.70 ns  ¬±1008.33%     0 ns     1000 ns\n0 cerl_sets:intersection        2.66 M      375.86 ns  ¬±7893.27%     0 ns     1000 ns\n2 gb_sets:intersection          1.99 M      501.60 ns  ¬±5740.59%     0 ns     1000 ns\n\nComparison:\n1 mapsets:intersection          8.50 M\n3 ordsets:intersection          4.96 M - 1.71x slower +84.06 ns\n0 cerl_sets:intersection        2.66 M - 3.20x slower +258.22 ns\n2 gb_sets:intersection          1.99 M - 4.26x slower +383.96 ns\n\n##### With input c2 Halt-right (10) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          5.61 M      178.32 ns  ¬±6353.45%     0 ns     1000 ns\n3 ordsets:intersection          3.27 M      305.53 ns  ¬±8831.03%     0 ns     1000 ns\n0 cerl_sets:intersection        1.61 M      619.53 ns  ¬±5512.50%     0 ns     1000 ns\n2 gb_sets:intersection          1.20 M      830.39 ns  ¬±3587.38%  1000 ns     1000 ns\n\nComparison:\n1 mapsets:intersection          5.61 M\n3 ordsets:intersection          3.27 M - 1.71x slower +127.21 ns\n0 cerl_sets:intersection        1.61 M - 3.47x slower +441.21 ns\n2 gb_sets:intersection          1.20 M - 4.66x slower +652.07 ns\n\n##### With input c3 Halt-right (30) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          3.02 M        0.33 Œºs ¬±10877.75%     0 Œºs        1 Œºs\n3 ordsets:intersection          1.76 M        0.57 Œºs  ¬±6736.07%     0 Œºs        1 Œºs\n0 cerl_sets:intersection        0.83 M        1.20 Œºs  ¬±2066.14%     1 Œºs        2 Œºs\n2 gb_sets:intersection          0.56 M        1.80 Œºs  ¬±1442.53%     2 Œºs        3 Œºs\n\nComparison:\n1 mapsets:intersection          3.02 M\n3 ordsets:intersection          1.76 M - 1.71x slower +0.24 Œºs\n0 cerl_sets:intersection        0.83 M - 3.61x slower +0.87 Œºs\n2 gb_sets:intersection          0.56 M - 5.41x slower +1.46 Œºs\n\n##### With input c4 Half-right (50) #####\nName                               ips        average  deviation   median      99th %\n3 ordsets:intersection          1.42 M        0.70 Œºs  ¬±4101.38%     1 Œºs        1 Œºs\n1 mapsets:intersection          1.31 M        0.77 Œºs  ¬±5155.14%     1 Œºs        1 Œºs\n0 cerl_sets:intersection        0.48 M        2.07 Œºs  ¬±1105.13%     2 Œºs        3 Œºs\n2 gb_sets:intersection          0.37 M        2.69 Œºs   ¬±793.20%     2 Œºs        5 Œºs\n\nComparison:\n3 ordsets:intersection          1.42 M\n1 mapsets:intersection          1.31 M - 1.09x slower +0.0618 Œºs\n0 cerl_sets:intersection        0.48 M - 2.95x slower +1.37 Œºs\n2 gb_sets:intersection          0.37 M - 3.82x slower +1.98 Œºs\n\n##### With input d1 Equal (5) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          4.61 M      216.84 ns  ¬±4985.98%     0 ns     1000 ns\n3 ordsets:intersection          3.44 M      290.38 ns  ¬±9494.06%     0 ns     1000 ns\n0 cerl_sets:intersection        1.62 M      618.37 ns  ¬±5703.54%     0 ns     1000 ns\n2 gb_sets:intersection          1.48 M      677.41 ns  ¬±4388.76%  1000 ns     1000 ns\n\nComparison:\n1 mapsets:intersection          4.61 M\n3 ordsets:intersection          3.44 M - 1.34x slower +73.54 ns\n0 cerl_sets:intersection        1.62 M - 2.85x slower +401.53 ns\n2 gb_sets:intersection          1.48 M - 3.12x slower +460.57 ns\n\n##### With input d2 Equal (10) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          3.96 M      252.22 ns ¬±10397.76%     0 ns     1000 ns\n3 ordsets:intersection          2.95 M      338.84 ns  ¬±8900.72%     0 ns     1000 ns\n0 cerl_sets:intersection        1.16 M      862.62 ns  ¬±3981.08%  1000 ns     1000 ns\n2 gb_sets:intersection          0.90 M     1112.16 ns  ¬±2553.42%  1000 ns     2000 ns\n\nComparison:\n1 mapsets:intersection          3.96 M\n3 ordsets:intersection          2.95 M - 1.34x slower +86.61 ns\n0 cerl_sets:intersection        1.16 M - 3.42x slower +610.40 ns\n2 gb_sets:intersection          0.90 M - 4.41x slower +859.94 ns\n\n##### With input d3 Equal (30) #####\nName                               ips        average  deviation   median      99th %\n1 mapsets:intersection          2.31 M        0.43 Œºs  ¬±8998.97%     0 Œºs        1 Œºs\n3 ordsets:intersection          1.49 M        0.67 Œºs  ¬±3628.66%     1 Œºs        1 Œºs\n0 cerl_sets:intersection        0.52 M        1.94 Œºs   ¬±965.82%     2 Œºs        3 Œºs\n2 gb_sets:intersection          0.42 M        2.38 Œºs   ¬±878.07%     2 Œºs        4 Œºs\n\nComparison:\n1 mapsets:intersection          2.31 M\n3 ordsets:intersection          1.49 M - 1.55x slower +0.24 Œºs\n0 cerl_sets:intersection        0.52 M - 4.48x slower +1.51 Œºs\n2 gb_sets:intersection          0.42 M - 5.50x slower +1.95 Œºs\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003ch3\u003eUnioning sets of tuple-integers\u003c/h3\u003e\n\n\u003cpre\u003e\u003ccode\u003eOperating System: macOS\nCPU Information: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz\nNumber of Available Cores: 8\nAvailable memory: 16 GB\nElixir 1.9.0\nErlang 23-master\n\nBenchmark suite executing with the following configuration:\nwarmup: 2 s\ntime: 5 s\nmemory time: 0 ns\nparallel: 1\nEstimated total run time: 4.90 min\n\n##### With input a1 Interspersed (5) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        2.53 M      394.70 ns  ¬±7692.39%     0 ns       1000 ns\n3 ordsets:intersection        2.12 M      471.60 ns  ¬±1021.75%     0 ns       1000 ns\n2 gb_sets:intersection        1.30 M      768.44 ns  ¬±2657.04%  1000 ns       1000 ns\n\nComparison:\n1 mapsets:intersection        2.53 M\n3 ordsets:intersection        2.12 M - 1.19x slower +76.90 ns\n2 gb_sets:intersection        1.30 M - 1.95x slower +373.75 ns\n\n##### With input a2 Interspersed (10) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        1.96 M      510.95 ns  ¬±2509.15%     0 ns       1000 ns\n3 ordsets:intersection        1.30 M      770.06 ns   ¬±676.65%  1000 ns       1000 ns\n2 gb_sets:intersection        0.81 M     1240.22 ns  ¬±1388.14%  1000 ns       2000 ns\n\nComparison:\n1 mapsets:intersection        1.96 M\n3 ordsets:intersection        1.30 M - 1.51x slower +259.11 ns\n2 gb_sets:intersection        0.81 M - 2.43x slower +729.27 ns\n\n##### With input a3 Interspersed (30) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection      845.89 K        1.18 Œºs  ¬±2713.20%     1 Œºs          2 Œºs\n3 ordsets:intersection      495.26 K        2.02 Œºs   ¬±164.49%     2 Œºs          3 Œºs\n2 gb_sets:intersection      324.61 K        3.08 Œºs   ¬±718.13%     3 Œºs          5 Œºs\n\nComparison:\n1 mapsets:intersection      845.89 K\n3 ordsets:intersection      495.26 K - 1.71x slower +0.84 Œºs\n2 gb_sets:intersection      324.61 K - 2.61x slower +1.90 Œºs\n\n##### With input b1 Half-left (5) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        4.66 M      214.57 ns  ¬±1896.59%     0 ns       1000 ns\n3 ordsets:intersection        3.62 M      276.50 ns  ¬±1465.48%     0 ns       1000 ns\n2 gb_sets:intersection        1.73 M      577.07 ns  ¬±5041.95%     0 ns       1000 ns\n\nComparison:\n1 mapsets:intersection        4.66 M\n3 ordsets:intersection        3.62 M - 1.29x slower +61.94 ns\n2 gb_sets:intersection        1.73 M - 2.69x slower +362.51 ns\n\n##### With input b2 Half-left (10) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        2.92 M      342.24 ns  ¬±9961.99%     0 ns       1000 ns\n3 ordsets:intersection        2.09 M      478.76 ns  ¬±5507.02%     0 ns       1000 ns\n2 gb_sets:intersection        0.96 M     1043.40 ns  ¬±2396.75%  1000 ns       2000 ns\n\nComparison:\n1 mapsets:intersection        2.92 M\n3 ordsets:intersection        2.09 M - 1.40x slower +136.53 ns\n2 gb_sets:intersection        0.96 M - 3.05x slower +701.17 ns\n\n##### With input b3 Half-left (30) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        1.72 M      580.48 ns  ¬±4998.64%     0 ns       1000 ns\n3 ordsets:intersection        1.01 M      989.96 ns  ¬±2850.03%  1000 ns       2000 ns\n2 gb_sets:intersection        0.44 M     2292.44 ns   ¬±981.37%  2000 ns       4000 ns\n\nComparison:\n1 mapsets:intersection        1.72 M\n3 ordsets:intersection        1.01 M - 1.71x slower +409.48 ns\n2 gb_sets:intersection        0.44 M - 3.95x slower +1711.96 ns\n\n##### With input b4 Half-left (50) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection      902.32 K        1.11 Œºs  ¬±1892.28%     1 Œºs          2 Œºs\n3 ordsets:intersection      710.61 K        1.41 Œºs  ¬±1793.08%     1 Œºs          2 Œºs\n2 gb_sets:intersection      282.62 K        3.54 Œºs   ¬±495.73%     3 Œºs         11 Œºs\n\nComparison:\n1 mapsets:intersection      902.32 K\n3 ordsets:intersection      710.61 K - 1.27x slower +0.30 Œºs\n2 gb_sets:intersection      282.62 K - 3.19x slower +2.43 Œºs\n\n##### With input c1 Halt-right (5) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        4.70 M      212.66 ns  ¬±1573.58%     0 ns       1000 ns\n3 ordsets:intersection        3.77 M      265.19 ns  ¬±1597.40%     0 ns       1000 ns\n2 gb_sets:intersection        1.76 M      567.11 ns  ¬±4249.42%     0 ns       1000 ns\n\nComparison:\n1 mapsets:intersection        4.70 M\n3 ordsets:intersection        3.77 M - 1.25x slower +52.53 ns\n2 gb_sets:intersection        1.76 M - 2.67x slower +354.45 ns\n\n##### With input c2 Halt-right (10) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        3.14 M      318.35 ns  ¬±7626.82%     0 ns       1000 ns\n3 ordsets:intersection        2.23 M      449.20 ns  ¬±5268.98%     0 ns       1000 ns\n2 gb_sets:intersection        0.99 M     1014.32 ns  ¬±2177.84%  1000 ns       2000 ns\n\nComparison:\n1 mapsets:intersection        3.14 M\n3 ordsets:intersection        2.23 M - 1.41x slower +130.85 ns\n2 gb_sets:intersection        0.99 M - 3.19x slower +695.97 ns\n\n##### With input c3 Halt-right (30) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        1.78 M      560.38 ns  ¬±5118.91%     0 ns       1000 ns\n3 ordsets:intersection        1.01 M      989.13 ns  ¬±2292.17%  1000 ns       2000 ns\n2 gb_sets:intersection        0.44 M     2294.68 ns   ¬±981.21%  2000 ns       4000 ns\n\nComparison:\n1 mapsets:intersection        1.78 M\n3 ordsets:intersection        1.01 M - 1.77x slower +428.75 ns\n2 gb_sets:intersection        0.44 M - 4.09x slower +1734.30 ns\n\n##### With input c4 Half-right (50) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection      875.40 K        1.14 Œºs  ¬±1770.92%     1 Œºs          2 Œºs\n3 ordsets:intersection      703.96 K        1.42 Œºs  ¬±1911.40%     1 Œºs          3 Œºs\n2 gb_sets:intersection      294.25 K        3.40 Œºs   ¬±488.43%     3 Œºs          6 Œºs\n\nComparison:\n1 mapsets:intersection      875.40 K\n3 ordsets:intersection      703.96 K - 1.24x slower +0.28 Œºs\n2 gb_sets:intersection      294.25 K - 2.98x slower +2.26 Œºs\n\n##### With input d1 Equal (5) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        3.29 M      303.69 ns  ¬±9348.28%     0 ns       1000 ns\n3 ordsets:intersection        2.19 M      455.98 ns  ¬±5799.97%     0 ns       1000 ns\n2 gb_sets:intersection        1.15 M      869.11 ns  ¬±3884.46%  1000 ns       2000 ns\n\nComparison:\n1 mapsets:intersection        3.29 M\n3 ordsets:intersection        2.19 M - 1.50x slower +152.29 ns\n2 gb_sets:intersection        1.15 M - 2.86x slower +565.41 ns\n\n##### With input d2 Equal (10) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection        2.93 M      341.11 ns  ¬±3839.65%     0 ns       1000 ns\n3 ordsets:intersection        1.85 M      540.08 ns  ¬±2436.90%     0 ns       1000 ns\n2 gb_sets:intersection        0.72 M     1388.21 ns  ¬±1540.59%  1000 ns       2000 ns\n\nComparison:\n1 mapsets:intersection        2.93 M\n3 ordsets:intersection        1.85 M - 1.58x slower +198.97 ns\n2 gb_sets:intersection        0.72 M - 4.07x slower +1047.11 ns\n\n##### With input d3 Equal (30) #####\nName                             ips        average  deviation   median        99th %\n1 mapsets:intersection     1395.63 K        0.72 Œºs  ¬±4359.84%     1 Œºs          1 Œºs\n3 ordsets:intersection      744.64 K        1.34 Œºs  ¬±1845.56%     1 Œºs          2 Œºs\n2 gb_sets:intersection      302.52 K        3.31 Œºs   ¬±672.80%     3 Œºs         10 Œºs\n\nComparison:\n1 mapsets:intersection     1395.63 K\n3 ordsets:intersection      744.64 K - 1.87x slower +0.63 Œºs\n2 gb_sets:intersection      302.52 K - 4.61x slower +2.59 Œºs\n\u003c/code\u003e\u003c/pre\u003e\n"}},"__N_SSG":true},"page":"/eeps/[eep]","query":{"eep":"eep-0050"},"buildId":"LNcThF2jK_Vf0EYibERT7","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"charSet":"utf-8"}],["title",{"children":"Erlang Programming Language"}],["meta",{"httpEquiv":"Content-Type","content":"text/html;charset=utf-8"}],["meta",{"name":"description","content":"Erlang Programming Language"}],["meta",{"name":"keywords","content":"erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"}],["meta",{"name":"viewport","content":"width=device-width, initial-scale=1.0"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Overall RSS 2.0 Feed","href":"/rss"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"News RSS 2.0 Feed","href":"/rss/news"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Article RSS 2.0 Feed","href":"/rss/articles"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Events RSS 2.0 Feed","href":"/rss/event"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Downloads RSS 2.0 Feed","href":"/rss/download"}],["script",{"src":"https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"}],["script",{"src":"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js","integrity":"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa","crossOrigin":"anonymous"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-8bebc7aacc0076174a73.js"></script><script src="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" async=""></script><script src="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" async=""></script><script src="/_next/static/chunks/pages/_app-290342a5f5c41b7caf9d.js" async=""></script><script src="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" async=""></script><script src="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" async=""></script><script src="/_next/static/LNcThF2jK_Vf0EYibERT7/_buildManifest.js" async=""></script><script src="/_next/static/LNcThF2jK_Vf0EYibERT7/_ssgManifest.js" async=""></script></body></html>