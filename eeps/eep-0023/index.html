<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Erlang Programming Language</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"/><meta name="description" content="Erlang Programming Language"/><meta name="keywords" content="erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="alternate" type="application/rss+xml" title="Overall RSS 2.0 Feed" href="/rss"/><link rel="alternate" type="application/rss+xml" title="News RSS 2.0 Feed" href="/rss/news"/><link rel="alternate" type="application/rss+xml" title="Article RSS 2.0 Feed" href="/rss/articles"/><link rel="alternate" type="application/rss+xml" title="Events RSS 2.0 Feed" href="/rss/event"/><link rel="alternate" type="application/rss+xml" title="Downloads RSS 2.0 Feed" href="/rss/download"/><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><link rel="preload" href="/_next/static/css/4ee9685e1cc0da7f69f0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4ee9685e1cc0da7f69f0.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-290342a5f5c41b7caf9d.js" as="script"/><link rel="preload" href="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" as="script"/></head><body><div id="__next"><div class="navbar" style="background-color:#FFF;margin-bottom:0px"><div class="container"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse" style="position:absolute;right:5px;margin-bottom:0px"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img src="/img/erlang.png" width="60"/></a><div class="nav-collapse collapse navbar-responsive-collapse" style="padding:20px"><ul class="nav navbar-nav"><li><a class="menu-headlines" href="/downloads/"> DOWNLOADS </a></li><li><a class="menu-headlines" href="/docs/"> DOCUMENTATION </a></li><li><a class="menu-headlines" href="/community/"> COMMUNITY </a></li><li><a class="menu-headlines" href="/news/"> NEWS </a></li><li><a class="menu-headlines" href="/eeps/"> EEPS </a></li><li><a class="menu-headlines" href="/blog/"> BLOG </a></li><li><a class="menu-headlines" href="/about/"> ABOUT </a></li></ul></div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="static_div"><pre><code>Author: Richard A. O'Keefe &lt;ok(at)cs(dot)otago(dot)ac(dot)nz&gt;
Status: Final/R12B-4 Proposal is implemented in OTP release R12B-4
Type: Standards Track
Erlang-Version: R12B-4
Created: 08-Aug-2008
Post-History:
</code></pre>

<hr />

<h2><a href="/eeps/eep-0000" title="EEP Index">EEP</a> 23: <a href="eep-0023.md" title="EEP Source"> Allow variables in <code>fun M:F/A</code></a></h2>

<h1>Abstract</h1>

<p><code>fun M:F/A</code> should allow <code>M</code>, <code>F</code>, and/or <code>A</code> to be a variable.</p>

<h1>Specification</h1>

<p>The form <code>fun M:F/A</code> currently requires <code>M</code> to be an atom,
<code>F</code> to be an atom, and <code>A</code> to be a non-negative integer.
This is generalised to allow any or all of them to be
variables.</p>

<h1>Motivation</h1>

<p>Representing functions by tuples <code>{M,F,A}</code> is now deprecated.
Yet there are times when some of this information is not
available until run time.  For example, a behaviour's author
might wish to refer to the <code>start/0</code> function in the Callback
module, but there might be any number of Callback modules at
run time.</p>

<p>It is absurd that the module name and function name in a call
of the form <code>M:F(E1, ..., En)</code> may be either atoms or variables,
but that they may not be variables in <code>fun M:F/A</code>.</p>

<p>It turns out that <code>fun M:F/A</code> is currently implemented as a call
to <code>erlang:make_fun(M, F, A)</code>, so the ability to create such
funs given run-time data already exists.  All that is missing
is to wrap some syntax around it.</p>

<h1>Rationale</h1>

<p>The gap that's being filled here is one that has been felt in
practice.  See a September 2008 thread in the Erlang mailing list.
The proposal generalises an existing form, but not more than the
existing function call syntax has already been generalised.</p>

<p>It is perhaps the limits of this proposal that need explaining.</p>

<p>First, the extension is from constants to constants or variables,
not to arbitrary expressions.  This is mainly to avoid confusing
parsers and people.  The effect of <code>fun (E1):(E2)/(E3)</code> can be had
by writing <code>M = E1, F = E2, A = E3, fun M:F/A</code>, so there is no loss
of expressiveness.  Since Erlang's equivalent of a lambda form
begins with "<code>fun (</code>", <code>fun (E1):...</code> would be tricky to parse and
very confusing to people.</p>

<p>Second, the extension is for <code>fun M:F/A</code> only, and not for <code>fun F/A</code>.
That's because there is no <code>erlang:make_fun/2</code> to call; the
implementation of <code>fun F/A</code> is surprisingly tricky and involves
creating a special-purpose glue function.  For many purposes,
<code>fun ?MODULE:F/A</code> will serve instead.</p>

<h1>Backwards Compatibility</h1>

<p>All existing Erlang code remains acceptable with unchanged
semantics.  No new functions or instructions are added, so
BEAM files produced with the new parser will work in older
releases.</p>

<h1>Reference Implementation</h1>

<p>The auxiliary file <a href="eep-0023-1.diff" title="Diff to apply to erl_parse.yrl">eep-0023-1.diff</a>
is a patch file to be applied to erl_parse.yrl.
The patched file has been checked by yecc, which is happy
with it, and the resulting .erl file compiles cleanly.
However, that's all the testing that has been done.</p>

<p>All that the implementation does is to</p>

<ol>
<li>accept <code>fun M:F/A</code> where <code>M</code>, <code>F</code>, and <code>A</code> are constants or
variables,</li>
<li>generate the same abstract syntax term that was
generated in the past when they are all constants,</li>
<li>pretend that <code>erlang:make_fun(M, F, A)</code> had been written
when at least one is a variable.
Only the parser is involved.</li>
</ol>

<h1>Copyright</h1>

<p>This document has been placed in the public domain.</p>
</div></div></div><div class="container"><div class="row"><div class="col-lg-12"><div class="divider"><p></p></div></div><div class="col-lg-12 text-center"><div class="col-lg-4"><a title="DOWNLOAD" href="/download.html"><img src="/img/download.png"/></a></div><div class="col-lg-4"><a href="http://www.github.com/erlang/otp/"><img src="/img/GitHub-Mark-32px.png"/></a></div><div class="col-lg-4"><a href="http://www.twitter.com/erlang_org/"><img src="/img/twitter.png" width="32"/></a></div></div><div class="col-lg-12"><div class="divider"><p></p></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"index":{"id":"0023","content":"\u003cpre\u003e\u003ccode\u003eAuthor: Richard A. O'Keefe \u0026lt;ok(at)cs(dot)otago(dot)ac(dot)nz\u0026gt;\nStatus: Final/R12B-4 Proposal is implemented in OTP release R12B-4\nType: Standards Track\nErlang-Version: R12B-4\nCreated: 08-Aug-2008\nPost-History:\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003chr /\u003e\n\n\u003ch2\u003e\u003ca href=\"/eeps/eep-0000\" title=\"EEP Index\"\u003eEEP\u003c/a\u003e 23: \u003ca href=\"eep-0023.md\" title=\"EEP Source\"\u003e Allow variables in \u003ccode\u003efun M:F/A\u003c/code\u003e\u003c/a\u003e\u003c/h2\u003e\n\n\u003ch1\u003eAbstract\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003efun M:F/A\u003c/code\u003e should allow \u003ccode\u003eM\u003c/code\u003e, \u003ccode\u003eF\u003c/code\u003e, and/or \u003ccode\u003eA\u003c/code\u003e to be a variable.\u003c/p\u003e\n\n\u003ch1\u003eSpecification\u003c/h1\u003e\n\n\u003cp\u003eThe form \u003ccode\u003efun M:F/A\u003c/code\u003e currently requires \u003ccode\u003eM\u003c/code\u003e to be an atom,\n\u003ccode\u003eF\u003c/code\u003e to be an atom, and \u003ccode\u003eA\u003c/code\u003e to be a non-negative integer.\nThis is generalised to allow any or all of them to be\nvariables.\u003c/p\u003e\n\n\u003ch1\u003eMotivation\u003c/h1\u003e\n\n\u003cp\u003eRepresenting functions by tuples \u003ccode\u003e{M,F,A}\u003c/code\u003e is now deprecated.\nYet there are times when some of this information is not\navailable until run time.  For example, a behaviour's author\nmight wish to refer to the \u003ccode\u003estart/0\u003c/code\u003e function in the Callback\nmodule, but there might be any number of Callback modules at\nrun time.\u003c/p\u003e\n\n\u003cp\u003eIt is absurd that the module name and function name in a call\nof the form \u003ccode\u003eM:F(E1, ..., En)\u003c/code\u003e may be either atoms or variables,\nbut that they may not be variables in \u003ccode\u003efun M:F/A\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eIt turns out that \u003ccode\u003efun M:F/A\u003c/code\u003e is currently implemented as a call\nto \u003ccode\u003eerlang:make_fun(M, F, A)\u003c/code\u003e, so the ability to create such\nfuns given run-time data already exists.  All that is missing\nis to wrap some syntax around it.\u003c/p\u003e\n\n\u003ch1\u003eRationale\u003c/h1\u003e\n\n\u003cp\u003eThe gap that's being filled here is one that has been felt in\npractice.  See a September 2008 thread in the Erlang mailing list.\nThe proposal generalises an existing form, but not more than the\nexisting function call syntax has already been generalised.\u003c/p\u003e\n\n\u003cp\u003eIt is perhaps the limits of this proposal that need explaining.\u003c/p\u003e\n\n\u003cp\u003eFirst, the extension is from constants to constants or variables,\nnot to arbitrary expressions.  This is mainly to avoid confusing\nparsers and people.  The effect of \u003ccode\u003efun (E1):(E2)/(E3)\u003c/code\u003e can be had\nby writing \u003ccode\u003eM = E1, F = E2, A = E3, fun M:F/A\u003c/code\u003e, so there is no loss\nof expressiveness.  Since Erlang's equivalent of a lambda form\nbegins with \"\u003ccode\u003efun (\u003c/code\u003e\", \u003ccode\u003efun (E1):...\u003c/code\u003e would be tricky to parse and\nvery confusing to people.\u003c/p\u003e\n\n\u003cp\u003eSecond, the extension is for \u003ccode\u003efun M:F/A\u003c/code\u003e only, and not for \u003ccode\u003efun F/A\u003c/code\u003e.\nThat's because there is no \u003ccode\u003eerlang:make_fun/2\u003c/code\u003e to call; the\nimplementation of \u003ccode\u003efun F/A\u003c/code\u003e is surprisingly tricky and involves\ncreating a special-purpose glue function.  For many purposes,\n\u003ccode\u003efun ?MODULE:F/A\u003c/code\u003e will serve instead.\u003c/p\u003e\n\n\u003ch1\u003eBackwards Compatibility\u003c/h1\u003e\n\n\u003cp\u003eAll existing Erlang code remains acceptable with unchanged\nsemantics.  No new functions or instructions are added, so\nBEAM files produced with the new parser will work in older\nreleases.\u003c/p\u003e\n\n\u003ch1\u003eReference Implementation\u003c/h1\u003e\n\n\u003cp\u003eThe auxiliary file \u003ca href=\"eep-0023-1.diff\" title=\"Diff to apply to erl_parse.yrl\"\u003eeep-0023-1.diff\u003c/a\u003e\nis a patch file to be applied to erl_parse.yrl.\nThe patched file has been checked by yecc, which is happy\nwith it, and the resulting .erl file compiles cleanly.\nHowever, that's all the testing that has been done.\u003c/p\u003e\n\n\u003cp\u003eAll that the implementation does is to\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eaccept \u003ccode\u003efun M:F/A\u003c/code\u003e where \u003ccode\u003eM\u003c/code\u003e, \u003ccode\u003eF\u003c/code\u003e, and \u003ccode\u003eA\u003c/code\u003e are constants or\nvariables,\u003c/li\u003e\n\u003cli\u003egenerate the same abstract syntax term that was\ngenerated in the past when they are all constants,\u003c/li\u003e\n\u003cli\u003epretend that \u003ccode\u003eerlang:make_fun(M, F, A)\u003c/code\u003e had been written\nwhen at least one is a variable.\nOnly the parser is involved.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1\u003eCopyright\u003c/h1\u003e\n\n\u003cp\u003eThis document has been placed in the public domain.\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/eeps/[eep]","query":{"eep":"eep-0023"},"buildId":"NPm6cMGILpqRmaNHZXj9d","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"charSet":"utf-8"}],["title",{"children":"Erlang Programming Language"}],["meta",{"httpEquiv":"Content-Type","content":"text/html;charset=utf-8"}],["meta",{"name":"description","content":"Erlang Programming Language"}],["meta",{"name":"keywords","content":"erlang, functional, programming, fault-tolerant, distributed, multi-platform, portable, software, multi-core, smp, concurrency"}],["meta",{"name":"viewport","content":"width=device-width, initial-scale=1.0"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Overall RSS 2.0 Feed","href":"/rss"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"News RSS 2.0 Feed","href":"/rss/news"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Article RSS 2.0 Feed","href":"/rss/articles"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Events RSS 2.0 Feed","href":"/rss/event"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Downloads RSS 2.0 Feed","href":"/rss/download"}],["script",{"src":"https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"}],["script",{"src":"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js","integrity":"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa","crossOrigin":"anonymous"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-8bebc7aacc0076174a73.js"></script><script src="/_next/static/chunks/main-a9a86200c2afaf3f233a.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" async=""></script><script src="/_next/static/chunks/commons.8b4ad2366e12f882e3d5.js" async=""></script><script src="/_next/static/chunks/pages/_app-290342a5f5c41b7caf9d.js" async=""></script><script src="/_next/static/chunks/87b308f4a72b1b263da2fe072492c20d1199252a.8368050723e578161621.js" async=""></script><script src="/_next/static/chunks/pages/eeps/%5Beep%5D-bde5f12f7c4b26eeb23e.js" async=""></script><script src="/_next/static/NPm6cMGILpqRmaNHZXj9d/_buildManifest.js" async=""></script><script src="/_next/static/NPm6cMGILpqRmaNHZXj9d/_ssgManifest.js" async=""></script></body></html>